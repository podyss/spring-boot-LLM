{"version":3,"file":"KeyFrames.js","sources":["../src/animation/KeyFrames.tsx"],"sourcesContent":["import {defineComponent, ref, h, onActivated, Fragment, onMounted, ExtractPublicPropTypes, PropType} from 'vue'\n\n\nimport noop from './utils/noop';\nimport Animation from './Animation';\n\nexport interface KeyFramesProps1 {\n  frames?: any[];\n  loop?: boolean;\n  forwardInstance?: (value: any) => void;\n  onFrame?: (value: any) => void;\n  onKeyRest?: (value: any) => void;\n  onRest?: (value: any) => void;\n}\n\nexport interface KeyFramesStates {\n  currentStyle: any;\n  frameIndex: number;\n}\n\n\n\nexport const vuePropsType = {\n  forwardInstance: Function as PropType<(value: any) => void>,\n  name: String,\n  frames: {\n    type: Array,\n    default: ():any[]=>[],\n  },\n  loop: {\n    type: Boolean,\n    default: false,\n  },\n  onKeyRest: {\n    type: Function as PropType<(value: any) => void>,\n    default: ()=>noop\n  },\n  onRest: {\n    type: Function as PropType<(value: any) => void>,\n    default: ()=>noop\n  },\n  onFrame: {\n    type: Function as PropType<(value: any) => void>,\n    default: ()=>noop\n  },\n}\nexport type KeyFramesProps = ExtractPublicPropTypes<typeof vuePropsType>\nconst KeyFrames = defineComponent(\n  (props, {slots}) => {\n\n    let instance: any;\n\n    const currentStyle = ref({});\n    const frameIndex = ref(0);\n\n\n    const onFrame = (props0 = {}) => {\n      const currentStyle0 = {...props0};\n\n      props.onFrame(currentStyle);\n      currentStyle.value = currentStyle0;\n    };\n\n    const next = () => {\n      const {frames, loop} = props;\n\n      frameIndex.value++;\n\n      if (frameIndex.value < frames.length - 1) {\n        // setState({ frameIndex });\n      } else {\n        frameIndex.value = 0;\n        props.onRest(currentStyle.value);\n\n        if (loop) {\n          // setState({ frameIndex });\n        }\n      }\n\n      props.onKeyRest(currentStyle.value);\n    };\n\n    const forwardInstance = (instance0: any) => {\n      instance = instance0;\n\n      if (typeof props.forwardInstance === 'function') {\n        props.forwardInstance(instance0);\n      }\n    };\n\n\n    onMounted(() => {\n      instance && instance.destroy();\n    })\n\n\n    const {frames} = props;\n\n\n    const from = frames[frameIndex.value];\n    const to = frames[frameIndex.value + 1];\n\n    return ()=>(\n      <Animation\n        {...props}\n        forwardInstance={forwardInstance}\n        from={from}\n        to={to}\n        onFrame={onFrame}\n        onRest={next}\n      >\n        {slots.default ? (typeof slots.default() === 'function' ? slots.default(currentStyle) : slots.default()) : null}\n      </Animation>\n    );\n  },\n  {\n    props: vuePropsType\n  }\n)\n\n\nexport default KeyFrames\n\n"],"names":["vuePropsType","forwardInstance","Function","name","String","frames","type","Array","default","loop","Boolean","onKeyRest","noop","onRest","onFrame","KeyFrames","defineComponent","props","slots","instance","currentStyle","ref","frameIndex","props0","currentStyle0","value","next","length","instance0","onMounted","destroy","from","to","_createVNode","Animation","_mergeProps"],"mappings":";;;AAsBO,MAAMA,IAAe;AAAA,EAC1BC,iBAAiBC;AAAAA,EACjBC,MAAMC;AAAAA,EACNC,QAAQ;AAAA,IACNC,MAAMC;AAAAA,IACNC,SAASA,MAAU,CAAA;AAAA,EACpB;AAAA,EACDC,MAAM;AAAA,IACJH,MAAMI;AAAAA,IACNF,SAAS;AAAA,EACV;AAAA,EACDG,WAAW;AAAA,IACTL,MAAMJ;AAAAA,IACNM,SAASA,MAAII;AAAAA,EACd;AAAA,EACDC,QAAQ;AAAA,IACNP,MAAMJ;AAAAA,IACNM,SAASA,MAAII;AAAAA,EACd;AAAA,EACDE,SAAS;AAAA,IACPR,MAAMJ;AAAAA,IACNM,SAASA,MAAII;AAAAA,EACf;AACF,GAEMG,IAAYC,gBAAAA,EAChB,CAACC,GAAO;AAAA,EAACC,OAAAA;AAAK,MAAM;AAElB,MAAIC;AAEJ,QAAMC,IAAeC,EAAI,CAAA,CAAE,GACrBC,IAAaD,EAAI,CAAC,GAGlBP,IAAUA,CAACS,IAAS,OAAO;AAC/B,UAAMC,IAAgB;AAAA,MAAC,GAAGD;AAAAA;AAE1BN,IAAAA,EAAMH,QAAQM,CAAY,GAC1BA,EAAaK,QAAQD;AAAAA,KAGjBE,IAAOA,MAAM;AACjB,UAAM;AAAA,MAACrB,QAAAA;AAAAA,MAAQI,MAAAA;AAAAA,IAAK,IAAGQ;AAEvBK,IAAAA,EAAWG,SAEPH,EAAWG,QAAQpB,EAAOsB,SAAS,MAGrCL,EAAWG,QAAQ,GACnBR,EAAMJ,OAAOO,EAAaK,KAAK,IAOjCR,EAAMN,UAAUS,EAAaK,KAAK;AAAA,KAG9BxB,IAAmB2B,CAAAA,MAAmB;AAC1CT,IAAAA,IAAWS,GAEP,OAAOX,EAAMhB,mBAAoB,cACnCgB,EAAMhB,gBAAgB2B,CAAS;AAAA;AAKnCC,EAAAA,EAAU,MAAM;AACdV,IAAAA,KAAYA,EAASW;EACvB,CAAC;AAGD,QAAM;AAAA,IAACzB,QAAAA;AAAAA,EAAO,IAAGY,GAGXc,IAAO1B,EAAOiB,EAAWG,KAAK,GAC9BO,IAAK3B,EAAOiB,EAAWG,QAAQ,CAAC;AAEtC,SAAO,MAAAQ,EAAAC,GAAAC,EAEClB,GAAK;AAAA,IAAA,iBACQhB;AAAAA,IAAe,MAC1B8B;AAAAA,IAAI,IACNC;AAAAA,IAAE,SACGlB;AAAAA,IAAO,QACRY;AAAAA,EAAI,CAAA,GAAA;AAAA,IAAAlB,SAAAA,MAEXU,CAAAA,EAAMV,UAAW,OAAOU,EAAMV,QAAS,KAAK,aAAaU,EAAMV,QAAQY,CAAY,IAAIF,EAAMV,QAAS,IAAI,IAAI;AAAA,GAElH;AACH,GACA;AAAA,EACES,OAAOjB;AACT,CACF;"}