{"version":3,"file":"basicSteps.js","sources":["../../src/components/steps/basicSteps.tsx"],"sourcesContent":["import * as PropTypes from '../PropTypes';\nimport cls from 'classnames';\nimport { stepsClasses as css } from '@douyinfe/semi-foundation/steps/constants';\nimport {\n  defineComponent,\n  useSlots,\n  h,\n  CSSProperties,\n  isVNode,\n  VNode,\n  cloneVNode,\n  ComponentObjectPropsOptions,\n  PropType,\n  useAttrs,\n} from 'vue';\nimport { vuePropsMake } from '../PropTypes';\nimport { noop } from 'lodash';\nimport { BasicStepProps } from './basicStep';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport { getFragmentChildren } from '../_utils';\nimport { CombineProps } from '../interface';\n\nexport type Direction = 'horizontal' | 'vertical';\nexport type Status = 'wait' | 'process' | 'finish' | 'error' | 'warning';\nexport type Size = 'default' | 'small';\nexport interface BasicStepsProps {\n  prefixCls?: string;\n  className?: string;\n  direction?: Direction;\n  current?: number;\n  initial?: number;\n  status?: Status;\n  style?: CSSProperties;\n  size?: Size;\n  hasLine?: boolean;\n  children?: VNode[];\n  onChange?: (current: number) => void;\n  'aria-label'?: string;\n}\n\nconst propTypes: CombineProps<BasicStepsProps> = {\n  prefixCls: PropTypes.string,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  current: PropTypes.number,\n  initial: PropTypes.number,\n  direction: PropTypes.string as PropType<BasicStepsProps['direction']>,\n  status: PropTypes.string as PropType<BasicStepsProps['status']>,\n  hasLine: PropTypes.bool,\n  children: PropTypes.node as PropType<BasicStepsProps['children']>,\n  onChange: PropTypes.func as PropType<BasicStepsProps['onChange']>,\n  'aria-label': PropTypes.string,\n  size: PropTypes.string as PropType<BasicStepsProps['size']>,\n};\n\nconst defaultProps = {\n  prefixCls: css.PREFIX,\n  current: 0,\n  direction: 'horizontal',\n  size: '',\n  initial: 0,\n  hasLine: true,\n  status: 'process',\n  onChange: noop,\n};\nexport const vuePropsType = vuePropsMake<BasicStepsProps>(propTypes, defaultProps);\nconst Steps = defineComponent({\n  props: { ...vuePropsType },\n  name: 'Steps',\n  setup(props, {}) {\n    const slots = useSlots();\n    const attrs = useAttrs();\n\n    return () => {\n      const children = slots.default?.();\n      const { size, current, status, prefixCls, initial, direction, className, style, hasLine, onChange, ...rest } =\n        props;\n\n      const inner = () => {\n        const filteredChildren = getFragmentChildren(slots).filter((c) => isVNode(c)) as Array<VNode>;\n        const content = filteredChildren.map((child: VNode, index) => {\n          if (!child) {\n            return null;\n          }\n          const stepNumber = initial + index;\n          const childProps: BasicStepProps = {\n            stepNumber: `${stepNumber + 1}`,\n            size,\n            ...child.props,\n          };\n\n          if (status === 'error' && index === current - 1) {\n            childProps.className = `${prefixCls}-next-error`;\n          }\n\n          if (!child.props.status) {\n            if (stepNumber === current) {\n              childProps.status = status;\n            } else if (stepNumber < current) {\n              childProps.status = 'finish';\n            } else {\n              childProps.status = 'wait';\n            }\n          }\n          childProps.active = stepNumber === current;\n          childProps.done = stepNumber < current;\n          childProps.onChange = onChange\n            ? () => {\n                if (index !== current) {\n                  onChange(index + initial);\n                }\n              }\n            : undefined;\n          return cloneVNode(child, { ...childProps });\n        });\n        return content;\n      };\n\n      const wrapperCls = cls(className, {\n        [`${prefixCls}-basic`]: true,\n        [`${prefixCls}-${direction}`]: true,\n        [`${prefixCls}-${size}`]: size !== 'default',\n        [`${prefixCls}-hasline`]: hasLine,\n      });\n\n      return (\n        <div aria-label={props['aria-label']} class={wrapperCls} style={style} {...getDataAttr({ ...rest, ...attrs })}>\n          {inner()}\n        </div>\n      );\n    };\n  },\n});\n\nexport default Steps;\n"],"names":["propTypes","prefixCls","PropTypes","string","className","style","object","current","number","initial","direction","status","hasLine","bool","children","node","onChange","func","size","defaultProps","css","PREFIX","noop","vuePropsType","vuePropsMake","Steps","defineComponent","props","name","setup","slots","useSlots","attrs","useAttrs","default","rest","inner","getFragmentChildren","filter","c","isVNode","map","child","index","stepNumber","childProps","active","done","undefined","cloneVNode","wrapperCls","cls","_createVNode","_mergeProps","getDataAttr"],"mappings":"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"}