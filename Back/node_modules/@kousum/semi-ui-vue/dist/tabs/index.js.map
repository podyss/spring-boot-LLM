{"version":3,"file":"index.js","sources":["../../src/components/tabs/index.tsx"],"sourcesContent":["import cls from 'classnames';\nimport * as PropTypes from '../PropTypes';\nimport { vuePropsMake } from '../PropTypes';\nimport { cssClasses } from '@douyinfe/semi-foundation/tabs/constants';\nimport isNullOrUndefined from '@douyinfe/semi-foundation/utils/isNullOrUndefined';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport TabsFoundation, { TabsAdapter } from '@douyinfe/semi-foundation/tabs/foundation';\nimport { isEqual, pick } from 'lodash';\nimport '@douyinfe/semi-foundation/tabs/tabs.scss';\n\nimport TabBar from './TabBar';\nimport TabPane from './TabPane';\nimport TabItem from './TabItem';\nimport TabsContext from './tabs-context';\nimport type { PlainTab, TabBarProps, TabContextValue, TabsProps } from './interface';\nimport {\n  ComponentObjectPropsOptions,\n  defineComponent,\n  h,\n  isVNode,\n  PropType,\n  reactive,\n  ref,\n  shallowRef,\n  useSlots,\n  VNode,\n  watch,\n} from 'vue';\nimport { useBaseComponent, useHasInProps } from '../_base/baseComponent';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { getFragmentChildren } from '../_utils';\n\nconst panePickKeys = ['className', 'style', 'disabled', 'itemKey', 'tab', 'icon'];\n\nexport * from './interface';\n\nexport interface TabsState {\n  activeKey: string;\n  panes: PlainTab[];\n  prevActiveKey: string | null;\n  forceDisableMotion: boolean;\n}\n\nconst propTypes: CombineProps<TabsProps> = {\n  activeKey: PropTypes.string,\n  className: PropTypes.string,\n  collapsible: PropTypes.bool,\n  contentStyle: PropTypes.oneOfType([PropTypes.object]),\n  defaultActiveKey: PropTypes.string,\n  keepDOM: PropTypes.bool,\n  lazyRender: PropTypes.bool,\n  onChange: PropTypes.func as PropType<TabsProps['onChange']>,\n  onTabClick: PropTypes.func as PropType<TabsProps['onTabClick']>,\n  renderTabBar: PropTypes.func as PropType<TabsProps['renderTabBar']>,\n  showRestInDropdown: PropTypes.bool,\n  size: PropTypes.string as PropType<TabsProps['size']>,\n  style: PropTypes.object,\n  tabBarClassName: PropTypes.string,\n  tabBarExtraContent: PropTypes.node,\n  tabBarStyle: PropTypes.object,\n  tabList: PropTypes.array,\n  tabPaneMotion: PropTypes.bool,\n  tabPosition: PropTypes.string as PropType<TabsProps['tabPosition']>,\n  type: PropTypes.string as PropType<TabsProps['type']>,\n  onTabClose: PropTypes.func as PropType<TabsProps['onTabClose']>,\n  preventScroll: PropTypes.bool,\n  more: PropTypes.oneOfType([PropTypes.number, PropTypes.object]),\n  arrowPosition: PropTypes.string as PropType<TabsProps['arrowPosition']>,\n  renderArrow: PropTypes.func as PropType<TabsProps['renderArrow']>,\n  dropdownProps: PropTypes.object as PropType<TabsProps['dropdownProps']>,\n  onVisibleTabsChange: PropTypes.func as PropType<TabsProps['onVisibleTabsChange']>,\n  visibleTabsStyle: PropTypes.object,\n};\n\nconst defaultProps: TabsProps = {\n  // children: [],\n  collapsible: false,\n  keepDOM: true,\n  lazyRender: false,\n  onChange: () => undefined,\n  onTabClick: () => undefined,\n  size: 'large',\n  tabPaneMotion: true,\n  tabPosition: 'top',\n  type: 'line',\n  onTabClose: () => undefined,\n  showRestInDropdown: true,\n  arrowPosition: 'both',\n};\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\n\nconst Index = defineComponent({\n  props: { ...vuePropsType, children: Array as PropType<VNode[]> },\n  name: 'TabsIndex',\n  setup(props, {}) {\n    const slots = useSlots();\n    const contentRef = ref();\n    let contentHeight: string = 'auto';\n\n\n    const state = reactive<TabsState>({\n      activeKey: '',\n      panes: getPanes(),\n      prevActiveKey: null,\n      forceDisableMotion: false,\n    });\n    const { adapter: adapterInject } = useBaseComponent<TabsProps>(props, state);\n    function adapter_(): TabsAdapter<TabsProps, TabsState> {\n      return {\n        ...adapterInject(),\n        collectPane: (): void => {\n          const panes = getPanes();\n          state.panes = panes as any;\n        },\n        collectActiveKey: (): void => {\n          const { tabList, activeKey: propsActiveKey } = props;\n          if (typeof propsActiveKey !== 'undefined') {\n            return;\n          }\n          const { activeKey } = state;\n          const panes = getPanes();\n          if (panes.findIndex((p) => p.itemKey === activeKey) === -1) {\n            if (panes.length > 0) {\n              state.activeKey = panes[0].itemKey;\n            } else {\n              state.activeKey = '';\n            }\n          }\n        },\n        notifyTabClick: (activeKey: string, event: MouseEvent): void => {\n          props.onTabClick(activeKey, event);\n        },\n        notifyChange: (activeKey: string): void => {\n          props.onChange(activeKey);\n        },\n        setNewActiveKey: (activeKey: string): void => {\n          state.activeKey = activeKey;\n        },\n        getDefaultActiveKeyFromChildren: (): string => {\n          const { tabList } = props;\n          let activeKey = '';\n          const list = tabList ? tabList : props.children.map((child) => (isVNode(child) ? child.props : null));\n          list.forEach((item) => {\n            if (item && !activeKey && !item.disabled) {\n              activeKey = item.itemKey;\n            }\n          });\n          return activeKey;\n        },\n        notifyTabDelete: (tabKey: string) => {\n          props.onTabClose && props.onTabClose(tabKey);\n        },\n      };\n    }\n    const adapter = adapter_();\n\n    const foundation = new TabsFoundation(adapter);\n    state.activeKey = foundation.getDefaultActiveKey();\n\n    function getDerivedStateFromProps(props: TabsProps): Partial<TabsState> {\n      const states: Partial<TabsState> = {};\n      if (!isNullOrUndefined(props.activeKey) && props.activeKey !== state.activeKey) {\n        state.prevActiveKey = state.activeKey;\n        states.activeKey = props.activeKey;\n      }\n      return states;\n    }\n\n    watch([() => props.activeKey], () => {\n      const newState = getDerivedStateFromProps({ ...props });\n      if (newState) {\n        Object.keys(newState).forEach((key) => {\n          state[key] = newState[key];\n        });\n      }\n    });\n\n    watch(\n      [() => props.children, () => props.tabList, () => props.activeKey, () => state.activeKey],\n      (value, [prevPropsChildren, prevPropsTabList, prevPropsActiveKey, prevStateActiveKey]) => {\n\n        // Panes state acts on tab bar, no need to compare TabPane children\n        const prevChildrenProps = (prevPropsChildren || []).map((child) =>\n          pick(isVNode(child) ? child.props : null, panePickKeys)\n        );\n\n        const nowChildrenProps = (props.children || []).map((child) =>\n          pick(isVNode(child) ? child.props : null, panePickKeys)\n        );\n\n        const isTabListType = props.tabList || prevPropsTabList;\n\n        if (!isEqual(props.tabList, prevPropsTabList)) {\n          foundation.handleTabListChange();\n        }\n\n        if (prevStateActiveKey !== state.activeKey && prevStateActiveKey !== state.prevActiveKey) {\n          state.prevActiveKey = prevStateActiveKey;\n        }\n\n        if (prevPropsActiveKey !== props.activeKey) {\n          const newAddedPanelItemKey = (() => {\n            const prevItemKeys = new Set(prevChildrenProps.map((p) => p.itemKey));\n            return nowChildrenProps.map((p) => p.itemKey).filter((itemKey) => !prevItemKeys.has(itemKey));\n          })();\n          state.forceDisableMotion = newAddedPanelItemKey.includes(props.activeKey);\n        }\n\n        // children变化，tabList方式使用时，啥也不用做\n        // children变化，非tabList方式使用，需要重新取activeKey。TabPane可能是异步更新的，若不重新取，未设activeKey时，第一个不会自动激活\n        // children changed: do nothing in tabList case\n        // children changed: recalc activeKey. TabPane could be updated async. If not recalc the first panel will not be activated\n        if (!isEqual(prevChildrenProps, nowChildrenProps) && !isTabListType) {\n          foundation.handleTabPanesChange();\n        }\n      }\n    );\n\n    const setContentRef = (ref) => {\n      contentRef.value = ref;\n    };\n\n    function getPanes(): PlainTab[] {\n      const { tabList } = props;\n      if (Array.isArray(tabList) && tabList.length) {\n        return tabList;\n      }\n      return props.children\n        .filter((child) => {\n          return typeof child.type !== 'symbol' && (child.type as any)?.name === 'TabPane';\n        })\n        .map((child) => {\n          if (child) {\n            const { tab, icon, disabled, itemKey, closable } = child.props;\n            return { tab, icon, disabled, itemKey, closable };\n          }\n          return undefined;\n        });\n    }\n\n    const onTabClick = (activeKey: string, event: MouseEvent): void => {\n      foundation.handleTabClick(activeKey, event);\n    };\n\n    /* istanbul ignore next */\n    const rePosChildren = (children: VueJsxNode[], activeKey: string) => {\n      const newChildren: VueJsxNode[] = [];\n\n      const falttenChildren = children as VNode[];\n\n      if (children.length) {\n        newChildren.push(...falttenChildren.filter((child) => child.props && child.props.itemKey === activeKey));\n        newChildren.push(...falttenChildren.filter((child) => child.props && child.props.itemKey !== activeKey));\n      }\n\n      return newChildren;\n    };\n\n    const getActiveItem = () => {\n      const { activeKey } = state;\n      const { tabList } = props;\n      if (tabList || !Array.isArray(props.children)) {\n        return props.children;\n      }\n      return props.children.filter((pane) => {\n        if (isVNode(pane) && pane.type && (pane.type as any).isTabPane) {\n          return pane.props.itemKey === activeKey;\n        }\n        return true;\n      });\n    };\n\n    const deleteTabItem = (tabKey: string, event: MouseEvent) => {\n      event.stopPropagation();\n      foundation.handleTabDelete(tabKey);\n    };\n\n    return () => {\n\n      const {\n        className,\n        collapsible,\n        contentStyle,\n        keepDOM,\n        lazyRender,\n        renderTabBar,\n        showRestInDropdown,\n        size,\n        style,\n        tabBarClassName,\n        tabBarExtraContent,\n        tabBarStyle,\n        tabPaneMotion,\n        tabPosition,\n        type,\n        more,\n        onVisibleTabsChange,\n        visibleTabsStyle,\n        arrowPosition,\n        renderArrow,\n        dropdownProps,\n        ...restProps\n      } = props;\n      const { panes, activeKey } = state;\n      const tabWrapperCls = cls(className, {\n        [cssClasses.TABS]: true,\n        [`${cssClasses.TABS}-${tabPosition}`]: tabPosition,\n      });\n\n      const tabContentCls = cls({\n        [cssClasses.TABS_CONTENT]: true,\n        [`${cssClasses.TABS_CONTENT}-${tabPosition}`]: tabPosition,\n      });\n\n      const tabBarProps = {\n        activeKey,\n        className: tabBarClassName,\n        collapsible,\n        list: panes as any,\n        onTabClick: onTabClick,\n        showRestInDropdown,\n        size,\n        style: tabBarStyle,\n        tabBarExtraContent,\n        tabPosition,\n        type,\n        deleteTabItem: deleteTabItem,\n        handleKeyDown: foundation.handleKeyDown,\n        more,\n        onVisibleTabsChange,\n        visibleTabsStyle,\n        arrowPosition,\n        renderArrow,\n        dropdownProps,\n      } as TabBarProps;\n\n      const tabBar = renderTabBar ? renderTabBar(tabBarProps, TabBar) : <TabBar {...tabBarProps} />;\n      const content = keepDOM ? props.children : getActiveItem();\n\n      return (\n        <div class={tabWrapperCls} style={style} {...getDataAttr(restProps)}>\n          {tabBar}\n          <TabsContext.Provider\n            value={\n              {\n                activeKey,\n                lazyRender,\n                panes: panes as any,\n                tabPaneMotion,\n                tabPosition,\n                prevActiveKey: state.prevActiveKey,\n                forceDisableMotion: state.forceDisableMotion,\n              } as TabContextValue\n            }\n          >\n            <div ref={setContentRef} class={tabContentCls} style={{ ...contentStyle }}>\n              {content}\n            </div>\n          </TabsContext.Provider>\n        </div>\n      );\n    };\n  },\n});\nconst Tabs = defineComponent({\n  props: { ...vuePropsType },\n  name: 'Tabs',\n  setup(props, {}) {\n    const slots = useSlots();\n    const {getProps} = useHasInProps()\n\n    return () => {\n      const children = getFragmentChildren(slots)\n      return (\n        <Index {...getProps(props)} children={children}/>\n      );\n    };\n  },\n});\nexport default Tabs;\n\nexport { TabPane, TabItem };\n"],"names":["panePickKeys","propTypes","activeKey","PropTypes","string","className","collapsible","bool","contentStyle","oneOfType","object","defaultActiveKey","keepDOM","lazyRender","onChange","func","onTabClick","renderTabBar","showRestInDropdown","size","style","tabBarClassName","tabBarExtraContent","node","tabBarStyle","tabList","array","tabPaneMotion","tabPosition","type","onTabClose","preventScroll","more","number","arrowPosition","renderArrow","dropdownProps","onVisibleTabsChange","visibleTabsStyle","defaultProps","vuePropsType","vuePropsMake","Index","defineComponent","props","children","Array","name","setup","useSlots","contentRef","ref","state","reactive","panes","getPanes","prevActiveKey","forceDisableMotion","adapter","adapterInject","useBaseComponent","adapter_","collectPane","collectActiveKey","propsActiveKey","findIndex","p","itemKey","length","notifyTabClick","event","notifyChange","setNewActiveKey","getDefaultActiveKeyFromChildren","list","map","child","isVNode","forEach","item","disabled","notifyTabDelete","tabKey","foundation","TabsFoundation","getDefaultActiveKey","getDerivedStateFromProps","states","isNullOrUndefined","watch","newState","Object","keys","key","value","prevPropsChildren","prevPropsTabList","prevPropsActiveKey","prevStateActiveKey","prevChildrenProps","pick","nowChildrenProps","isTabListType","isEqual","handleTabListChange","newAddedPanelItemKey","prevItemKeys","Set","filter","has","includes","handleTabPanesChange","setContentRef","isArray","tab","icon","closable","handleTabClick","getActiveItem","pane","isTabPane","deleteTabItem","stopPropagation","handleTabDelete","restProps","tabWrapperCls","cls","cssClasses","TABS","tabContentCls","TABS_CONTENT","tabBarProps","handleKeyDown","tabBar","TabBar","_createVNode","content","_mergeProps","getDataAttr","TabsContext","Provider","default","Tabs","slots","getProps","useHasInProps","getFragmentChildren"],"mappings":"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"}