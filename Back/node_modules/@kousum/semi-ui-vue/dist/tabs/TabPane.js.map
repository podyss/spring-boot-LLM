{"version":3,"file":"TabPane.js","sources":["../../src/components/tabs/TabPane.tsx"],"sourcesContent":["import * as PropTypes from '../PropTypes';\nimport { vuePropsMake } from '../PropTypes';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/tabs/constants';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport { PlainTab, TabPaneProps } from './interface';\nimport CSSAnimation from '../_cssAnimation';\nimport { defineComponent, h, useSlots } from 'vue';\nimport { useTabsContext } from './tabs-context/Consumer';\nimport { CombineProps } from '../interface';\n\nconst propTypes: CombineProps<{\n  className?: string;\n  style?: any;\n  children?: any;\n  disabled?: boolean;\n  itemKey?: string;\n  tab?: any;\n  icon?: any;\n  closable?: boolean;\n  tabIndex?: number;\n}> = {\n  className: PropTypes.string,\n  style: PropTypes.object,\n  children: PropTypes.node,\n  disabled: PropTypes.bool,\n  itemKey: PropTypes.string,\n  tab: [Function, ...PropTypes.node],\n  icon: PropTypes.node,\n  closable: PropTypes.bool,\n  tabIndex: PropTypes.number,\n};\nexport const vuePropsType = vuePropsMake(propTypes, {});\nconst TabPane = defineComponent({\n  props: { ...vuePropsType },\n  name: 'TabPane',\n  ...{ isTabPane: true },\n  setup(props, {}) {\n    const slots = useSlots();\n\n    const { context } = useTabsContext();\n    let _active: boolean;\n\n    // get direction from current item key to activeKey\n    const getDirection = (\n      activeKey: string,\n      itemKey: string,\n      panes: Array<PlainTab>,\n      lastActiveKey: string\n    ): boolean => {\n      if (itemKey !== null && activeKey !== null && Array.isArray(panes) && panes.length) {\n        const activeIndex = panes.findIndex((pane) => pane.itemKey === activeKey);\n        const itemIndex = panes.findIndex((pane) => pane.itemKey === itemKey);\n        const lastActiveIndex = panes.findIndex((pane) => pane.itemKey === lastActiveKey);\n\n        if (activeIndex === itemIndex) {\n          return lastActiveIndex > activeIndex;\n        } else {\n          return itemIndex < activeIndex;\n        }\n      }\n\n      return false;\n    };\n\n    const shouldRenderFunc = (): boolean => {\n      const { itemKey } = props;\n      const { activeKey, lazyRender } = context.value;\n      const active = activeKey === itemKey;\n      _active = _active || active;\n      return lazyRender ? _active : true;\n    };\n\n    const ChildCache = defineComponent(() => () => slots.default?.());\n\n    return () => {\n      const { tabPaneMotion: motion, tabPosition, prevActiveKey } = context.value;\n      const { className, style, itemKey, tabIndex, ...restProps } = props;\n      const active = context.value.activeKey === itemKey;\n      const classNames = cls(className, {\n        [cssClasses.TABS_PANE_INACTIVE]: !active,\n        [cssClasses.TABS_PANE_ACTIVE]: active,\n        [cssClasses.TABS_PANE]: true,\n      });\n      const shouldRender = shouldRenderFunc();\n      const startClassName = (() => {\n        const direction = getDirection(context.value.activeKey, itemKey, context.value.panes as any, prevActiveKey);\n        if (tabPosition === 'top') {\n          if (direction) {\n            return cssClasses.TABS_PANE_ANIMATE_RIGHT_SHOW;\n          } else {\n            return cssClasses.TABS_PANE_ANIMATE_LEFT_SHOW;\n          }\n        } else {\n          if (direction) {\n            return cssClasses.TABS_PANE_ANIMATE_BOTTOM_SHOW;\n          } else {\n            return cssClasses.TABS_PANE_ANIMATE_TOP_SHOW;\n          }\n        }\n      })();\n\n      const isActivatedBecauseOtherTabPaneRemoved = !(context.value.panes as any as PlainTab[]).find(\n        (tabPane) => tabPane.itemKey === prevActiveKey\n      );\n      const hasMotion = motion && active && !isActivatedBecauseOtherTabPaneRemoved && !context.value.forceDisableMotion;\n      \n      return (\n        <div\n          role=\"tabpanel\"\n          id={`semiTabPanel${itemKey}`}\n          key={`semiTabPanel${itemKey}`}\n          aria-labelledby={`semiTab${itemKey}`}\n          class={classNames}\n          style={style}\n          aria-hidden={active ? 'false' : 'true'}\n          tabindex={tabIndex ? tabIndex : 0}\n          {...getDataAttr(restProps)}\n          x-semi-prop=\"children\"\n        >\n          <CSSAnimation\n            motion={hasMotion}\n            animationState={active ? 'enter' : 'leave'}\n            startClassName={startClassName}\n            children={({ animationClassName, animationEventsNeedBind }) => {\n              return (\n                <div\n                  class={cls(cssClasses.TABS_PANE_MOTION_OVERLAY, animationClassName)}\n                  x-semi-prop=\"children\"\n                  {...animationEventsNeedBind}\n                >\n                  {shouldRender ? <ChildCache/> : null}\n                </div>\n              );\n            }}\n          ></CSSAnimation>\n        </div>\n      );\n    };\n  },\n});\n\nexport default TabPane;\n"],"names":["propTypes","className","PropTypes","string","style","object","children","node","disabled","bool","itemKey","tab","Function","icon","closable","tabIndex","number","vuePropsType","vuePropsMake","TabPane","defineComponent","props","name","isTabPane","setup","slots","useSlots","context","useTabsContext","_active","getDirection","activeKey","panes","lastActiveKey","Array","isArray","length","activeIndex","findIndex","pane","itemIndex","lastActiveIndex","shouldRenderFunc","lazyRender","value","ChildCache","default","tabPaneMotion","motion","tabPosition","prevActiveKey","restProps","active","classNames","cls","cssClasses","TABS_PANE_INACTIVE","TABS_PANE_ACTIVE","TABS_PANE","shouldRender","startClassName","direction","TABS_PANE_ANIMATE_RIGHT_SHOW","TABS_PANE_ANIMATE_LEFT_SHOW","TABS_PANE_ANIMATE_BOTTOM_SHOW","TABS_PANE_ANIMATE_TOP_SHOW","isActivatedBecauseOtherTabPaneRemoved","find","tabPane","hasMotion","forceDisableMotion","_createVNode","_mergeProps","getDataAttr","CSSAnimation","animationClassName","animationEventsNeedBind","TABS_PANE_MOTION_OVERLAY"],"mappings":"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"}