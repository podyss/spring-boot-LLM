{"version":3,"file":"TabBar.js","sources":["../../src/components/tabs/TabBar.tsx"],"sourcesContent":["import * as PropTypes from '../PropTypes';\nimport { vuePropsMake } from '../PropTypes';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/tabs/constants';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport OverflowList from '../overflowList';\nimport Dropdown, { DropdownItem, DropdownMenu, DropDownMenuItem, type DropdownProps } from '../dropdown';\nimport Button from '../button';\nimport { PlainTab, TabBarProps } from './interface';\nimport { isEmpty, pick } from 'lodash';\nimport { IconChevronDown, IconChevronLeft, IconChevronRight } from '@kousum/semi-icons-vue';\nimport { getUuidv4 } from '@douyinfe/semi-foundation/utils/uuid';\nimport TabItem from './TabItem';\nimport {\n  ComponentObjectPropsOptions,\n  defineComponent,\n  Fragment,\n  h,\n  onMounted,\n  PropType,\n  reactive,\n  ref,\n  useSlots,\n  VNode,\n  watch,\n} from 'vue';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { Locale } from '../locale/interface';\nimport LocaleConsumer from '../locale/localeConsumer';\n\nexport interface TabBarState {\n  endInd: number;\n  rePosKey: number;\n  startInd: number;\n  uuid: string;\n  currentVisibleItems: string[];\n}\n\nexport interface OverflowItem extends PlainTab {\n  key: string;\n  active: boolean;\n}\n\nconst propTypes: CombineProps<TabBarProps> = {\n  activeKey: PropTypes.string,\n  className: PropTypes.string,\n  collapsible: PropTypes.bool,\n  list: PropTypes.array,\n  onTabClick: PropTypes.func as PropType<TabBarProps['onTabClick']>,\n  size: PropTypes.string as PropType<TabBarProps['size']>,\n  style: PropTypes.object,\n  tabBarExtraContent: PropTypes.node,\n  tabPosition: PropTypes.string as PropType<TabBarProps['tabPosition']>,\n  type: PropTypes.string as PropType<TabBarProps['type']>,\n  closable: PropTypes.bool,\n  deleteTabItem: PropTypes.func as PropType<TabBarProps['deleteTabItem']>,\n  more: PropTypes.oneOfType([PropTypes.number, PropTypes.object]),\n  handleKeyDown: PropTypes.func as PropType<TabBarProps['handleKeyDown']>,\n  showRestInDropdown: PropTypes.bool,\n  dropdownClassName: PropTypes.string,\n  dropdownStyle: PropTypes.object,\n  onVisibleTabsChange: PropTypes.func as PropType<TabBarProps['onVisibleTabsChange']>,\n  visibleTabsStyle: PropTypes.object,\n  arrowPosition: PropTypes.string as PropType<TabBarProps['arrowPosition']>,\n  renderArrow: PropTypes.func as PropType<TabBarProps['renderArrow']>,\n  dropdownProps: PropTypes.object as PropType<TabBarProps['dropdownProps']>,\n};\n\nexport const vuePropsType = vuePropsMake(propTypes, {});\nconst TabBar = defineComponent({\n  props: { ...vuePropsType },\n  name: 'TabBar',\n  setup(props, { attrs }) {\n    const slots = useSlots();\n    const state = reactive({\n      endInd: props.list.length,\n      rePosKey: 0,\n      startInd: 0,\n      uuid: '',\n      currentVisibleItems: [],\n    });\n\n    onMounted(() => {\n      state.uuid = getUuidv4();\n    });\n\n    watch(\n      () => props.activeKey,\n      () => {\n        if (props.collapsible) {\n          scrollActiveTabItemIntoView();\n        }\n      }\n    );\n\n    function renderIcon(icon: VueJsxNode): VueJsxNode {\n      return <span>{icon}</span>;\n    }\n\n    function renderExtra(): VueJsxNode {\n      const { tabBarExtraContent, type, size } = props;\n      const tabBarExtraContentDefaultStyle = { float: 'right' };\n      const tabBarExtraContentStyle =\n        tabBarExtraContent && (tabBarExtraContent as VNode).props ? (tabBarExtraContent as VNode).props.style : {};\n      const extraCls = cls(cssClasses.TABS_BAR_EXTRA, {\n        [`${cssClasses.TABS_BAR}-${type}-extra`]: type,\n        [`${cssClasses.TABS_BAR}-${type}-extra-${size}`]: size,\n      });\n      if (tabBarExtraContent) {\n        const tabBarStyle = { ...tabBarExtraContentDefaultStyle, ...tabBarExtraContentStyle };\n        return (\n          <div class={extraCls} style={tabBarStyle} x-semi-prop=\"tabBarExtraContent\">\n            {tabBarExtraContent}\n          </div>\n        );\n      }\n      return null;\n    }\n\n    const handleItemClick = (itemKey: string, e: MouseEvent): void => {\n      props.onTabClick(itemKey, e);\n    };\n\n    const handleKeyDown = (event: KeyboardEvent, itemKey: string, closable: boolean) => {\n      props.handleKeyDown(event, itemKey, closable);\n    };\n\n    const renderTabItem = (panel: PlainTab): VNode => {\n      const { size, type, deleteTabItem, handleKeyDown, tabPosition } = props;\n      const isSelected = _isActive(panel.itemKey);\n\n      return (\n        <TabItem\n          {...pick(panel, ['disabled', 'icon', 'itemKey', 'tab', 'closable'])}\n          key={_getBarItemKeyByItemKey(panel.itemKey)}\n          selected={isSelected}\n          size={size}\n          type={type}\n          tabPosition={tabPosition}\n          handleKeyDown={handleKeyDown}\n          deleteTabItem={deleteTabItem}\n          onClick={handleItemClick}\n        />\n      );\n    };\n\n    const tabListNode = ref();\n    const scrollTabItemIntoViewByKey = (key: string, logicalPosition: ScrollLogicalPosition = 'nearest') => {\n      const tabItem = (tabListNode.value as HTMLElement).querySelector(\n        `[data-uuid=\"${state.uuid}\"] .${cssClasses.TABS_TAB}[data-scrollkey=${JSON.stringify(key)}]`\n      );\n      tabItem?.scrollIntoView({ behavior: 'smooth', block: logicalPosition, inline: logicalPosition });\n    };\n\n    const scrollActiveTabItemIntoView = (logicalPosition?: ScrollLogicalPosition) => {\n      const key = _getBarItemKeyByItemKey(props.activeKey);\n      scrollTabItemIntoViewByKey(key, logicalPosition);\n    };\n\n    const renderTabComponents = (list: Array<PlainTab>): Array<VueJsxNode> => list.map((panel) => renderTabItem(panel));\n\n    const handleArrowClick = (items: Array<OverflowItem>, pos: 'start' | 'end'): void => {\n      const lastItem = pos === 'start' ? items.pop() : items.shift();\n      if (!lastItem) {\n        return;\n      }\n      const key = _getBarItemKeyByItemKey(lastItem.itemKey);\n      scrollTabItemIntoViewByKey(key);\n    };\n\n    const renderCollapse = (items: Array<OverflowItem>, icon: VueJsxNode, pos: 'start' | 'end'): VueJsxNode => {\n      const arrowCls = cls({\n        [`${cssClasses.TABS_BAR}-arrow-${pos}`]: pos,\n        [`${cssClasses.TABS_BAR}-arrow`]: true,\n      });\n\n      if (isEmpty(items)) {\n        return (\n          <div role=\"presentation\" class={arrowCls}>\n            <Button disabled={true} icon={()=>icon} theme=\"borderless\" />\n          </div>\n        );\n      }\n      const { dropdownClassName, dropdownStyle, showRestInDropdown, dropdownProps } = props;\n      const { rePosKey } = state;\n      const disabled = !items.length;\n\n      const menu = (\n        <DropdownMenu>\n          {items.map((panel) => {\n            const { icon: i, tab, itemKey } = panel;\n            const panelIcon = ()=>i ? renderIcon(panel.icon) : null;\n            return (\n              <DropdownItem\n                key={itemKey}\n                onClick={(e): void => handleItemClick(itemKey, e)}\n                active={_isActive(itemKey)}\n              >\n                {panelIcon()}\n                {typeof tab === 'function'?tab():tab}\n              </DropdownItem>\n            );\n          })}\n        </DropdownMenu>\n      );\n\n      const button = (\n        <div role=\"presentation\" class={arrowCls} onClick={(e): void => handleArrowClick(items, pos)}>\n          <Button disabled={disabled} icon={()=>icon} theme=\"borderless\" />\n        </div>\n      );\n\n      const dropdownCls = cls(dropdownClassName, {\n        [`${cssClasses.TABS_BAR}-dropdown`]: true,\n      });\n\n      const customDropdownProps = dropdownProps?.[pos] ?? {};\n      return (\n        <Fragment>\n          {showRestInDropdown ? (\n            <Dropdown\n              className={dropdownCls}\n              clickToHide\n              clickTriggerToHide\n              key={`${rePosKey}-${pos}`}\n              position={pos === 'start' ? 'bottomLeft' : 'bottomRight'}\n              render={disabled ? null : menu}\n              showTick\n              style={dropdownStyle}\n              trigger={'hover'}\n              disableFocusListener // prevent the panel from popping up again after clicking\n              {...customDropdownProps}\n            >\n              {button}\n            </Dropdown>\n          ) : (\n            button\n          )}\n        </Fragment>\n      );\n    };\n\n    const renderOverflow = (items: any[]): Array<VueJsxNode> => {\n      return items.map((item, index) => {\n        const pos = index === 0 ? 'start' : 'end';\n        const icon = index === 0 ? <IconChevronLeft/> : <IconChevronRight/>;\n        const overflowNode = renderCollapse(item, icon, pos);\n        if (props.renderArrow) {\n          return props.renderArrow(item, pos, ()=>handleArrowClick(item, pos), overflowNode);\n        }\n        return overflowNode;\n      })\n    };\n\n    const renderCollapsedTab = (): VueJsxNode => {\n      const { list } = props;\n      const renderedList = list.map((item) => {\n        const { itemKey } = item;\n        return { key: _getBarItemKeyByItemKey(itemKey), active: _isActive(itemKey), ...item };\n      });\n      return (\n        <OverflowList\n          items={renderedList}\n          overflowRenderDirection={props.arrowPosition}\n          wrapperStyle={props.visibleTabsStyle}\n          overflowRenderer={renderOverflow}\n          // threshold -> 比较intersectionRatio -> isIntersecting 如果是数组会按最小的那个值来比较。\n          // tabBar总宽度不能小于每一个tabBar的宽度*threshold，不然计算会出错。\n          threshold={0.5}\n          renderMode=\"scroll\"\n          className={`${cssClasses.TABS_BAR}-overflow-list`}\n          visibleItemRenderer={renderTabItem as any}\n          onVisibleStateChange={(visibleMap) => {\n            const visibleMapWithItemKey: Map<string, boolean> = new Map();\n            visibleMap.forEach((v, k) => {\n              visibleMapWithItemKey.set(_getItemKeyByBarItemKey(k), v);\n            });\n            props.onVisibleTabsChange?.(visibleMapWithItemKey);\n          }}\n        />\n      );\n    };\n\n    const _isActive = (key: string): boolean => key === props.activeKey;\n\n    const _getBarItemKeyByItemKey = (key: string): string => `${key}-bar`;\n    const _getItemKeyByBarItemKey = (key: string): string => key.replace(/-bar$/, '');\n\n    const renderWithMoreTrigger = (): VNode => {\n      const { list, more } = props;\n      let tabElements: VNode[] = [];\n      let moreTrigger: VNode = (\n        <div\n          class={cls({\n            [`${cssClasses.TABS_BAR}-more-trigger`]: true,\n            [`${cssClasses.TABS_BAR}-more-trigger-${props.type}`]: true,\n          })}\n        >\n          <LocaleConsumer componentName=\"Tabs\">\n            {(locale: Locale['Tabs'], localeCode: Locale['code']) => (\n              <div class={`${cssClasses.TABS_BAR}-more-trigger-content`}>\n                <div>{locale.more}</div>\n                <IconChevronDown className={`${cssClasses.TABS_BAR}-more-trigger-content-icon`} />\n              </div>\n            )}\n          </LocaleConsumer>\n        </div>\n      );\n      let keepCount: number;\n      if (typeof more === 'number') {\n        keepCount = list.length - Math.min(more, list.length);\n        tabElements = list.slice(0, keepCount).map((panel) => renderTabItem(panel));\n      } else if (typeof more === 'object') {\n        keepCount = list.length - Math.min(more.count, list.length);\n        tabElements = list.slice(0, keepCount).map((panel) => renderTabItem(panel));\n        if (more.render) {\n          moreTrigger = more.render();\n        }\n      } else if (more !== undefined) {\n        throw new Error('[Semi Tabs]: invalid tab props format: more');\n      }\n\n      return (\n        <Fragment>\n          {tabElements}\n          {renderMoreDropdown(list.slice(keepCount), more?.['dropdownProps'], moreTrigger)}\n        </Fragment>\n      );\n    };\n\n    const renderMoreDropdown = (panels: PlainTab[], dropDownProps: DropdownProps, trigger: VNode): VNode => {\n      return (\n        <Dropdown\n          trigger={'hover'}\n          showTick\n          position={'bottomLeft'}\n          className={`${cssClasses.TABS_BAR}-more-dropdown-${props.type}`}\n          clickToHide={true}\n          menu={\n            panels.map((panel) => ({\n              node: 'item',\n              name: panel.tab as string,\n              icon: panel.icon,\n              onClick: (e) => props.onTabClick(panel.itemKey, e),\n              active: props.activeKey === panel.itemKey,\n            })) as DropDownMenuItem[]\n          }\n          {...dropDownProps}\n        >\n          {trigger}\n        </Dropdown>\n      );\n    };\n\n    return () => {\n      const { type, style, className, list, tabPosition, more, collapsible, handleKeyDown, ...restProps } = props;\n      const classNames = cls(className, {\n        [cssClasses.TABS_BAR]: true,\n        [cssClasses.TABS_BAR_LINE]: type === 'line',\n        [cssClasses.TABS_BAR_CARD]: type === 'card',\n        [cssClasses.TABS_BAR_BUTTON]: type === 'button',\n        [cssClasses.TABS_BAR_SLASH]: type === 'slash',\n        [`${cssClasses.TABS_BAR}-${tabPosition}`]: tabPosition,\n        [`${cssClasses.TABS_BAR}-collapse`]: collapsible,\n      });\n\n      const extra = renderExtra();\n      const contents = collapsible ? renderCollapsedTab() : more ? renderWithMoreTrigger() : renderTabComponents(list);\n      return (\n        <div\n          role=\"tablist\"\n          ref={tabListNode}\n          aria-orientation={tabPosition === 'left' ? 'vertical' : 'horizontal'}\n          class={classNames}\n          style={style}\n          {...getDataAttr(restProps)}\n          data-uuid={state.uuid}\n        >\n          {contents}\n          {extra}\n        </div>\n      );\n    };\n  },\n});\n\nexport default TabBar;\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","propTypes","activeKey","PropTypes","string","className","collapsible","bool","list","array","onTabClick","func","size","style","object","tabBarExtraContent","node","tabPosition","type","closable","deleteTabItem","more","oneOfType","number","handleKeyDown","showRestInDropdown","dropdownClassName","dropdownStyle","onVisibleTabsChange","visibleTabsStyle","arrowPosition","renderArrow","dropdownProps","vuePropsType","vuePropsMake","TabBar","defineComponent","props","name","setup","attrs","useSlots","state","reactive","endInd","length","rePosKey","startInd","uuid","currentVisibleItems","onMounted","getUuidv4","watch","scrollActiveTabItemIntoView","renderIcon","icon","_createVNode","renderExtra","tabBarExtraContentDefaultStyle","float","tabBarExtraContentStyle","extraCls","cls","cssClasses","TABS_BAR_EXTRA","TABS_BAR","tabBarStyle","handleItemClick","itemKey","e","renderTabItem","panel","isSelected","_isActive","TabItem","_mergeProps","pick","_getBarItemKeyByItemKey","tabListNode","ref","scrollTabItemIntoViewByKey","key","logicalPosition","tabItem","value","querySelector","TABS_TAB","JSON","stringify","scrollIntoView","behavior","block","inline","renderTabComponents","map","handleArrowClick","items","pos","lastItem","pop","shift","renderCollapse","_slot","arrowCls","isEmpty","Button","disabled","menu","DropdownMenu","i","tab","panelIcon","DropdownItem","default","button","dropdownCls","customDropdownProps","_Fragment","Dropdown","renderOverflow","item","index","IconChevronLeft","IconChevronRight","overflowNode","renderCollapsedTab","renderedList","active","OverflowList","visibleMap","visibleMapWithItemKey","Map","forEach","v","k","set","_getItemKeyByBarItemKey","replace","renderWithMoreTrigger","tabElements","moreTrigger","LocaleConsumer","locale","localeCode","IconChevronDown","keepCount","Math","min","slice","count","render","undefined","Error","renderMoreDropdown","panels","dropDownProps","trigger","onClick","restProps","classNames","TABS_BAR_LINE","TABS_BAR_CARD","TABS_BAR_BUTTON","TABS_BAR_SLASH","extra","contents","getDataAttr"],"mappings":";;;;;;;;;;;;;;AA4BsD,SAAAA,EAAAC,GAAA;AAAA,SAAA,OAAAA,KAAA,cAAAC,OAAAC,UAAAC,SAAAC,KAAAJ,CAAA,MAAAK,qBAAAA,CAAAA,GAAAL,CAAA;AAAA;AAetD,MAAMM,KAAuC;AAAA,EAC3CC,WAAWC,EAAUC;AAAAA,EACrBC,WAAWF,EAAUC;AAAAA,EACrBE,aAAaH,EAAUI;AAAAA,EACvBC,MAAML,EAAUM;AAAAA,EAChBC,YAAYP,EAAUQ;AAAAA,EACtBC,MAAMT,EAAUC;AAAAA,EAChBS,OAAOV,EAAUW;AAAAA,EACjBC,oBAAoBZ,EAAUa;AAAAA,EAC9BC,aAAad,EAAUC;AAAAA,EACvBc,MAAMf,EAAUC;AAAAA,EAChBe,UAAUhB,EAAUI;AAAAA,EACpBa,eAAejB,EAAUQ;AAAAA,EACzBU,MAAMlB,EAAUmB,UAAU,CAACnB,EAAUoB,QAAQpB,EAAUW,MAAM,CAAC;AAAA,EAC9DU,eAAerB,EAAUQ;AAAAA,EACzBc,oBAAoBtB,EAAUI;AAAAA,EAC9BmB,mBAAmBvB,EAAUC;AAAAA,EAC7BuB,eAAexB,EAAUW;AAAAA,EACzBc,qBAAqBzB,EAAUQ;AAAAA,EAC/BkB,kBAAkB1B,EAAUW;AAAAA,EAC5BgB,eAAe3B,EAAUC;AAAAA,EACzB2B,aAAa5B,EAAUQ;AAAAA,EACvBqB,eAAe7B,EAAUW;AAC3B,GAEamB,KAAeC,GAAajC,IAAW,EAAE,GAChDkC,KAASC,gBAAAA,EAAgB;AAAA,EAC7BC,OAAO;AAAA,IAAE,GAAGJ;AAAAA,EAAc;AAAA,EAC1BK,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,GAAG;AACRC,IAAAA,EAAU;AACxB,UAAMC,IAAQC,EAAS;AAAA,MACrBC,QAAQP,EAAM7B,KAAKqC;AAAAA,MACnBC,UAAU;AAAA,MACVC,UAAU;AAAA,MACVC,MAAM;AAAA,MACNC,qBAAqB,CAAA;AAAA,IACvB,CAAC;AAEDC,IAAAA,EAAU,MAAM;AACdR,MAAAA,EAAMM,OAAOG;IACf,CAAC,GAEDC,EACE,MAAMf,EAAMnC,WACZ,MAAM;AACJ,MAAImC,EAAM/B,eACR+C;IAEJ,CACF;AAEA,aAASC,EAAWC,GAA8B;AAChD,aAAAC,iBAAcD,CAAI,CAAA;AAAA,IACpB;AAEA,aAASE,IAA0B;AACjC,YAAM;AAAA,QAAE1C,oBAAAA;AAAAA,QAAoBG,MAAAA;AAAAA,QAAMN,MAAAA;AAAAA,MAAM,IAAGyB,GACrCqB,IAAiC;AAAA,QAAEC,OAAO;AAAA,SAC1CC,IACJ7C,KAAuBA,EAA6BsB,QAAStB,EAA6BsB,MAAMxB,QAAQ,IACpGgD,IAAWC,EAAIC,EAAWC,gBAAgB;AAAA,QAC9C,CAAC,GAAGD,EAAWE,QAAQ,IAAI/C,CAAI,QAAQ,GAAGA;AAAAA,QAC1C,CAAC,GAAG6C,EAAWE,QAAQ,IAAI/C,CAAI,UAAUN,CAAI,EAAE,GAAGA;AAAAA,MACpD,CAAC;AACD,UAAIG,GAAoB;AACtB,cAAMmD,IAAc;AAAA,UAAE,GAAGR;AAAAA,UAAgC,GAAGE;AAAAA;AAC5D,eAAAJ,EAAA,OAAA;AAAA,UAAA,OACcK;AAAAA,UAAQ,OAASK;AAAAA,UAAW,eAAA;AAAA,QAAA,GAAA,CACrCnD,CAAkB,CAAA;AAAA,MAGzB;AACA,aAAO;AAAA,IACT;AAEA,UAAMoD,IAAkBA,CAACC,GAAiBC,MAAwB;AAChEhC,MAAAA,EAAM3B,WAAW0D,GAASC,CAAC;AAAA,OAOvBC,IAAiBC,CAAAA,MAA2B;AAChD,YAAM;AAAA,QAAE3D,MAAAA;AAAAA,QAAMM,MAAAA;AAAAA,QAAME,eAAAA;AAAAA,QAAeI,eAAAA;AAAAA,QAAeP,aAAAA;AAAAA,MAAa,IAAGoB,GAC5DmC,IAAaC,EAAUF,EAAMH,OAAO;AAE1C,aAAAZ,EAAAkB,IAAAC,EAEQC,GAAKL,GAAO,CAAC,YAAY,QAAQ,WAAW,OAAO,UAAU,CAAC,GAAC;AAAA,QAAA,KAC9DM,EAAwBN,EAAMH,OAAO;AAAA,QAAC,UACjCI;AAAAA,QAAU,MACd5D;AAAAA,QAAI,MACJM;AAAAA,QAAI,aACGD;AAAAA,QAAW,eACTO;AAAAA,QAAa,eACbJ;AAAAA,QAAa,SACnB+C;AAAAA,MAAe,CAAA,GAAA,IAAA;AAAA,OAKxBW,IAAcC,MACdC,IAA6BA,CAACC,GAAaC,IAAyC,cAAc;AACtG,YAAMC,IAAWL,EAAYM,MAAsBC,cACjD,eAAe3C,EAAMM,IAAI,OAAOe,EAAWuB,QAAQ,mBAAmBC,KAAKC,UAAUP,CAAG,CAAC,GAC3F;AACAE,MAAAA,KAAAA,QAAAA,EAASM,eAAe;AAAA,QAAEC,UAAU;AAAA,QAAUC,OAAOT;AAAAA,QAAiBU,QAAQV;AAAAA,MAAgB;AAAA,OAG1F7B,IAA+B6B,CAAAA,MAA4C;AAC/E,YAAMD,IAAMJ,EAAwBxC,EAAMnC,SAAS;AACnD8E,MAAAA,EAA2BC,GAAKC,CAAe;AAAA,OAG3CW,IAAuBrF,CAAAA,MAA6CA,EAAKsF,IAAKvB,CAAAA,MAAUD,EAAcC,CAAK,CAAC,GAE5GwB,IAAmBA,CAACC,GAA4BC,MAA+B;AACnF,YAAMC,IAAWD,MAAQ,UAAUD,EAAMG,QAAQH,EAAMI;AACvD,UAAI,CAACF;AACH;AAEF,YAAMjB,IAAMJ,EAAwBqB,EAAS9B,OAAO;AACpDY,MAAAA,EAA2BC,CAAG;AAAA,OAG1BoB,IAAiBA,CAACL,GAA4BzC,GAAkB0C,MAAqC;AAAA,UAAAK;AACzG,YAAMC,IAAWzC,EAAI;AAAA,QACnB,CAAC,GAAGC,EAAWE,QAAQ,UAAUgC,CAAG,EAAE,GAAGA;AAAAA,QACzC,CAAC,GAAGlC,EAAWE,QAAQ,QAAQ,GAAG;AAAA,MACpC,CAAC;AAED,UAAIuC,GAAQR,CAAK;AACf,eAAAxC,EAAA,OAAA;AAAA,UAAA,MAAA;AAAA,UAAA,OACkC+C;AAAAA,WAAQ/C,CAAAA,EAAAiD,GAAA;AAAA,UAAA,UACpB;AAAA,UAAI,MAAQlD,MAAIA;AAAAA,UAAI,OAAA;AAAA,QAAA,GAAA,IAAA,CAAA,CAAA;AAI5C,YAAM;AAAA,QAAE7B,mBAAAA;AAAAA,QAAmBC,eAAAA;AAAAA,QAAeF,oBAAAA;AAAAA,QAAoBO,eAAAA;AAAAA,MAAe,IAAGK,GAC1E;AAAA,QAAES,UAAAA;AAAAA,MAAU,IAAGJ,GACfgE,IAAW,CAACV,EAAMnD,QAElB8D,IAAInD,EAAAoD,IAAAlH,MAAAA,EAAA4G,IAELN,EAAMF,IAAKvB,CAAAA,MAAU;AACpB,cAAM;AAAA,UAAEhB,MAAMsD;AAAAA,UAAGC,KAAAA;AAAAA,UAAK1C,SAAAA;AAAAA,QAAS,IAAGG,GAC5BwC,IAAYA,MAAIF,IAAIvD,EAAWiB,EAAMhB,IAAI,IAAI;AACnD,eAAAC,EAAAwD,IAAA;AAAA,UAAA,KAES5C;AAAAA,UAAO,SACFC,CAAAA,MAAYF,EAAgBC,GAASC,CAAC;AAAA,UAAC,QACzCI,EAAUL,CAAO;AAAA,QAAC,GAAA;AAAA,UAAA6C,SAAAA,MAAA,CAEzBF,KACA,OAAOD,KAAQ,aAAWA,EAAK,IAACA,CAAG;AAAA,QAAA,CAAA;AAAA,OAGzC,CAAC,IAAAR,IAAA;AAAA,QAAAW,SAAAA,MAAA,CAAAX,CAAA;AAAA,OAEL,GAEKY,IAAM1D,EAAA,OAAA;AAAA,QAAA,MAAA;AAAA,QAAA,OACsB+C;AAAAA,QAAQ,SAAYlC,CAAAA,MAAY0B,EAAiBC,GAAOC,CAAG;AAAA,SAACzC,CAAAA,EAAAiD,GAAA;AAAA,QAAA,UACxEC;AAAAA,QAAQ,MAAQnD,MAAIA;AAAAA,QAAI,OAAA;AAAA,SAE7C,IAAA,CAAA,CAAA,GAEK4D,IAAcrD,EAAIpC,GAAmB;AAAA,QACzC,CAAC,GAAGqC,EAAWE,QAAQ,WAAW,GAAG;AAAA,MACvC,CAAC,GAEKmD,KAAsBpF,KAAAA,gBAAAA,EAAgBiE,OAAQ,CAAA;AACpD,aAAAzC,EAAA6D,GAEK5F,MAAAA,CAAAA,IAAkB+B,EAAA8D,GAAA3C,EAAA;AAAA,QAAA,WAEJwC;AAAAA,QAAW,aAAA;AAAA,QAAA,oBAAA;AAAA,QAAA,KAGjB,GAAGrE,CAAQ,IAAImD,CAAG;AAAA,QAAE,UACfA,MAAQ,UAAU,eAAe;AAAA,QAAa,QAChDS,IAAW,OAAOC;AAAAA,QAAI,UAAA;AAAA,QAAA,OAEvBhF;AAAAA,QAAa,SACX;AAAA,QAAO,sBAAA;AAAA,MAAA,GAEZyF,CAAmB,GAAA1H,EAEtBwH,CAAM,IAANA,IAAM;AAAA,QAAAD,SAAAA,MAAA,CAANC,CAAM;AAAA,MAAA,CAAA,IAGTA,CACD,CAAA;AAAA,OAKDK,IAAkBvB,CAAAA,MACfA,EAAMF,IAAI,CAAC0B,GAAMC,MAAU;AAChC,YAAMxB,IAAMwB,MAAU,IAAI,UAAU,OAC9BlE,IAAOkE,MAAU,IAACjE,EAAAkE,IAAA,MAAA,IAAA,IAAAlE,EAAAmE,IAA2C,MAAA,IAAA,GAC7DC,IAAevB,EAAemB,GAAMjE,GAAM0C,CAAG;AACnD,aAAI5D,EAAMN,cACDM,EAAMN,YAAYyF,GAAMvB,GAAK,MAAIF,EAAiByB,GAAMvB,CAAG,GAAG2B,CAAY,IAE5EA;AAAAA,IACT,CAAC,GAGGC,IAAqBA,MAAkB;AAC3C,YAAM;AAAA,QAAErH,MAAAA;AAAAA,MAAM,IAAG6B,GACXyF,IAAetH,EAAKsF,IAAK0B,CAAAA,MAAS;AACtC,cAAM;AAAA,UAAEpD,SAAAA;AAAAA,QAAS,IAAGoD;AACpB,eAAO;AAAA,UAAEvC,KAAKJ,EAAwBT,CAAO;AAAA,UAAG2D,QAAQtD,EAAUL,CAAO;AAAA,UAAG,GAAGoD;AAAAA;MACjF,CAAC;AACD,aAAAhE,EAAAwE,IAAA;AAAA,QAAA,OAEWF;AAAAA,QAAY,yBACMzF,EAAMP;AAAAA,QAAa,cAC9BO,EAAMR;AAAAA,QAAgB,kBAClB0F;AAAAA,QAAc,WAGrB;AAAA,QAAG,YAAA;AAAA,QAAA,WAEH,GAAGxD,EAAWE,QAAQ;AAAA,QAAgB,qBAC5BK;AAAAA,QAAa,sBACX2D,CAAAA,MAAe;;AACpC,gBAAMC,IAA8C,oBAAIC;AACxDF,UAAAA,EAAWG,QAAQ,CAACC,GAAGC,MAAM;AAC3BJ,YAAAA,EAAsBK,IAAIC,EAAwBF,CAAC,GAAGD,CAAC;AAAA,UACzD,CAAC,IACDhG,IAAAA,EAAMT,wBAANS,QAAAA,EAAAA,KAAAA,GAA4B6F;AAAAA,QAC9B;AAAA,MAAC,GAAA,IAAA;AAAA,OAKDzD,IAAaQ,CAAAA,MAAyBA,MAAQ5C,EAAMnC,WAEpD2E,IAA2BI,CAAAA,MAAwB,GAAGA,CAAG,QACzDuD,IAA2BvD,CAAAA,MAAwBA,EAAIwD,QAAQ,SAAS,EAAE,GAE1EC,IAAwBA,MAAa;AACzC,YAAM;AAAA,QAAElI,MAAAA;AAAAA,QAAMa,MAAAA;AAAAA,MAAM,IAAGgB;AACvB,UAAIsG,IAAuB,CAAA,GACvBC,IAAkBpF,EAAA,OAAA;AAAA,QAAA,OAEXM,EAAI;AAAA,UACT,CAAC,GAAGC,EAAWE,QAAQ,eAAe,GAAG;AAAA,UACzC,CAAC,GAAGF,EAAWE,QAAQ,iBAAiB5B,EAAMnB,IAAI,EAAE,GAAG;AAAA,SACxD;AAAA,SAACsC,CAAAA,EAAAqF,IAAA;AAAA,QAAA,eAAA;AAAA,MAAA,GAAA;AAAA,QAAA5B,SAGCA,CAAC6B,GAAwBC,MAA0BvF,EAAA,OAAA;AAAA,UAAA,OACtC,GAAGO,EAAWE,QAAQ;AAAA,WAAuBT,CAAAA,gBACjDsF,EAAOzH,IAAI,CAAAmC,GAAAA,EAAAwF,IAAA;AAAA,UAAA,WACW,GAAGjF,EAAWE,QAAQ;AAAA,QAA4B,GAAA,IAAA,CAAA,CAAA;AAAA,MAKvF,CAAA,CAAA,CAAA,GACGgF;AACJ,UAAI,OAAO5H,KAAS;AAClB4H,QAAAA,IAAYzI,EAAKqC,SAASqG,KAAKC,IAAI9H,GAAMb,EAAKqC,MAAM,GACpD8F,IAAcnI,EAAK4I,MAAM,GAAGH,CAAS,EAAEnD,IAAKvB,CAAAA,MAAUD,EAAcC,CAAK,CAAC;AAAA,eACjE,OAAOlD,KAAS;AACzB4H,QAAAA,IAAYzI,EAAKqC,SAASqG,KAAKC,IAAI9H,EAAKgI,OAAO7I,EAAKqC,MAAM,GAC1D8F,IAAcnI,EAAK4I,MAAM,GAAGH,CAAS,EAAEnD,IAAKvB,CAAAA,MAAUD,EAAcC,CAAK,CAAC,GACtElD,EAAKiI,WACPV,IAAcvH,EAAKiI;eAEZjI,MAASkI;AAClB,cAAM,IAAIC,MAAM,6CAA6C;AAG/D,aAAAhG,EAAA6D,GAAA,MAAA,CAEKsB,GACAc,EAAmBjJ,EAAK4I,MAAMH,CAAS,GAAG5H,KAAAA,gBAAAA,EAAO,eAAkBuH,CAAW,CAAC,CAAA;AAAA,OAKhFa,IAAqBA,CAACC,GAAoBC,GAA8BC,MAC5EpG,EAAA8D,GAAA3C,EAAA;AAAA,MAAA,SAEa;AAAA,MAAO,UAAA;AAAA,MAAA,UAEN;AAAA,MAAY,WACX,GAAGZ,EAAWE,QAAQ,kBAAkB5B,EAAMnB,IAAI;AAAA,MAAE,aAClD;AAAA,MAAI,MAEfwI,EAAO5D,IAAKvB,CAAAA,OAAW;AAAA,QACrBvD,MAAM;AAAA,QACNsB,MAAMiC,EAAMuC;AAAAA,QACZvD,MAAMgB,EAAMhB;AAAAA,QACZsG,SAAUxF,CAAAA,MAAMhC,EAAM3B,WAAW6D,EAAMH,SAASC,CAAC;AAAA,QACjD0D,QAAQ1F,EAAMnC,cAAcqE,EAAMH;AAAAA,MACpC,EAAE;AAAA,IAAC,GAEDuF,CAAa,GAAAjK,EAEhBkK,CAAO,IAAPA,IAAO;AAAA,MAAA3C,SAAAA,MAAA,CAAP2C,CAAO;AAAA,IAAA,CAAA;AAKd,WAAO,MAAM;AACX,YAAM;AAAA,QAAE1I,MAAAA;AAAAA,QAAML,OAAAA;AAAAA,QAAOR,WAAAA;AAAAA,QAAWG,MAAAA;AAAAA,QAAMS,aAAAA;AAAAA,QAAaI,MAAAA;AAAAA,QAAMf,aAAAA;AAAAA,QAAakB,eAAAA;AAAAA,QAAe,GAAGsI;AAAAA,MAAW,IAAGzH,GAChG0H,IAAajG,EAAIzD,GAAW;AAAA,QAChC,CAAC0D,EAAWE,QAAQ,GAAG;AAAA,QACvB,CAACF,EAAWiG,aAAa,GAAG9I,MAAS;AAAA,QACrC,CAAC6C,EAAWkG,aAAa,GAAG/I,MAAS;AAAA,QACrC,CAAC6C,EAAWmG,eAAe,GAAGhJ,MAAS;AAAA,QACvC,CAAC6C,EAAWoG,cAAc,GAAGjJ,MAAS;AAAA,QACtC,CAAC,GAAG6C,EAAWE,QAAQ,IAAIhD,CAAW,EAAE,GAAGA;AAAAA,QAC3C,CAAC,GAAG8C,EAAWE,QAAQ,WAAW,GAAG3D;AAAAA,MACvC,CAAC,GAEK8J,IAAQ3G,KACR4G,IAAW/J,IAAcuH,EAAoB,IAAGxG,IAAOqH,EAAuB,IAAG7C,EAAoBrF,CAAI;AAC/G,aAAAgD,SAAAmB,EAAA;AAAA,QAAA,MAAA;AAAA,QAAA,KAGSG;AAAAA,QAAW,oBACE7D,MAAgB,SAAS,aAAa;AAAA,QAAY,OAC7D8I;AAAAA,QAAU,OACVlJ;AAAAA,SACHyJ,GAAYR,CAAS,GAAC;AAAA,QAAA,aACfpH,EAAMM;AAAAA,MAEhBqH,CAAAA,GAAAA,CAAAA,GACAD,CAAK,CAAA;AAAA;EAId;AACF,CAAC;"}