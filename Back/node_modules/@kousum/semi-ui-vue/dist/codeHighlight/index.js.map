{"version":3,"file":"index.js","sources":["../../src/components/codeHighlight/index.tsx"],"sourcesContent":["import {\n  defineComponent,\n  ref,\n  h,\n  Fragment,\n  useSlots,\n  PropType,\n  CSSProperties,\n  shallowRef,\n  reactive,\n  onMounted,\n  watch,\n} from 'vue';\nimport \"@douyinfe/semi-foundation/codeHighlight/codeHighlight.scss\";\nimport { CombineProps } from '../interface';\nimport * as PropTypes from '../PropTypes';\nimport { vuePropsMake } from '../PropTypes';\nimport CodeHighlightFoundation, {\n  CodeHighlightAdapter,\n  CodeHighlightBaseProps,\n  CodeHighlightBaseState,\n} from '@douyinfe/semi-foundation/codeHighlight';\nimport { useBaseComponent } from '../_base/baseComponent';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/codeHighlight/constants';\n\ninterface CodeHighlightProps extends CodeHighlightBaseProps {\n  className?: string;\n  style?: CSSProperties;\n  defaultTheme?: boolean;\n}\n\ninterface CodeHighlightState extends CodeHighlightBaseState {}\n\nconst propTypes: CombineProps<CodeHighlightProps> = {\n  className: PropTypes.string,\n  style: PropTypes.object,\n  code: {\n    type: PropTypes.string,\n    required: true,\n  },\n  language: {\n    type: PropTypes.string,\n    required: true,\n  },\n  lineNumber: {\n    type: PropTypes.bool,\n    required: true,\n  },\n  defaultTheme: PropTypes.bool,\n};\n\nconst defaultProps = {\n  lineNumber: true,\n  defaultTheme: true,\n};\n\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\nconst index = defineComponent({\n  props: { ...vuePropsType },\n  name: 'index',\n  setup(props, { attrs }) {\n    const slots = useSlots();\n    const codeRef = shallowRef();\n    const state = reactive({});\n    const { adapter: adapterInject, getDataAttr } = useBaseComponent(props, state);\n    function adapter_(): CodeHighlightAdapter<CodeHighlightProps, CodeHighlightState> {\n      return {\n        ...adapterInject(),\n      };\n    }\n    const adapter = adapter_();\n    const foundation = new CodeHighlightFoundation(adapter);\n\n    onMounted(() => {\n      if (codeRef.value) {\n        foundation.highlightCode(codeRef.value, props.language);\n      }\n    });\n\n    watch([() => props.code, () => props.language], (value, [prevPropsCode, prevPropsLanguage], onCleanup) => {\n      if ((codeRef.value && prevPropsCode !== props.code) || prevPropsLanguage !== props.language) {\n        foundation.highlightCode(codeRef.value, props.language);\n      }\n    });\n\n    return () => {\n      return (\n        <div\n          style={props.style}\n          class={cls(props.className, cssClasses.PREFIX, 'semi-light-scrollbar', {\n            [`${cssClasses.PREFIX}-defaultTheme`]: props.defaultTheme,\n          })}\n          {...getDataAttr()}\n        >\n          <pre>\n            <code ref={codeRef}>{props.code}</code>\n          </pre>\n        </div>\n      );\n    };\n  },\n});\n\nexport default index;\n"],"names":["propTypes","className","PropTypes","string","style","object","code","type","required","language","lineNumber","bool","defaultTheme","defaultProps","vuePropsType","vuePropsMake","index","defineComponent","props","name","setup","attrs","useSlots","codeRef","shallowRef","state","reactive","adapter","adapterInject","getDataAttr","useBaseComponent","adapter_","foundation","CodeHighlightFoundation","onMounted","value","highlightCode","watch","prevPropsCode","prevPropsLanguage","onCleanup","_createVNode","_mergeProps","cls","cssClasses","PREFIX"],"mappings":";;;;;;;;AAkCA,MAAMA,IAA8C;AAAA,EAClDC,WAAWC,EAAUC;AAAAA,EACrBC,OAAOF,EAAUG;AAAAA,EACjBC,MAAM;AAAA,IACJC,MAAML,EAAUC;AAAAA,IAChBK,UAAU;AAAA,EACX;AAAA,EACDC,UAAU;AAAA,IACRF,MAAML,EAAUC;AAAAA,IAChBK,UAAU;AAAA,EACX;AAAA,EACDE,YAAY;AAAA,IACVH,MAAML,EAAUS;AAAAA,IAChBH,UAAU;AAAA,EACX;AAAA,EACDI,cAAcV,EAAUS;AAC1B,GAEME,IAAe;AAAA,EACnBH,YAAY;AAAA,EACZE,cAAc;AAChB,GAEaE,IAAeC,EAAaf,GAAWa,CAAY,GAC1DG,IAAQC,gBAAAA,EAAgB;AAAA,EAC5BC,OAAO;AAAA,IAAE,GAAGJ;AAAAA,EAAc;AAAA,EAC1BK,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,GAAG;AACRC,IAAAA,EAAU;AACxB,UAAMC,IAAUC,KACVC,IAAQC,EAAS,CAAA,CAAE,GACnB;AAAA,MAAEC,SAASC;AAAAA,MAAeC,aAAAA;AAAAA,IAAY,IAAIC,EAAiBZ,GAAOO,CAAK;AAC7E,aAASM,IAAyE;AAChF,aAAO;AAAA,QACL,GAAGH,EAAc;AAAA;IAErB;AACA,UAAMD,IAAUI,KACVC,IAAa,IAAIC,EAAwBN,CAAO;AAEtDO,WAAAA,EAAU,MAAM;AACd,MAAIX,EAAQY,SACVH,EAAWI,cAAcb,EAAQY,OAAOjB,EAAMT,QAAQ;AAAA,IAE1D,CAAC,GAED4B,EAAM,CAAC,MAAMnB,EAAMZ,MAAM,MAAMY,EAAMT,QAAQ,GAAG,CAAC0B,GAAO,CAACG,GAAeC,CAAiB,GAAGC,MAAc;AACxG,OAAKjB,EAAQY,SAASG,MAAkBpB,EAAMZ,QAASiC,MAAsBrB,EAAMT,aACjFuB,EAAWI,cAAcb,EAAQY,OAAOjB,EAAMT,QAAQ;AAAA,IAE1D,CAAC,GAEM,MACLgC,SAAAC,EAAA;AAAA,MAAA,OAEWxB,EAAMd;AAAAA,MAAK,OACXuC,EAAIzB,EAAMjB,WAAW2C,EAAWC,QAAQ,wBAAwB;AAAA,QACrE,CAAC,GAAGD,EAAWC,MAAM,eAAe,GAAG3B,EAAMN;AAAAA,OAC9C;AAAA,IAAC,GACEiB,EAAW,CAAE,GAAAY,CAAAA,gBAAAA,EAAA,QAAA;AAAA,MAAA,KAGJlB;AAAAA,IAAUL,GAAAA,CAAAA,EAAMZ,IAAI,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,EAKzC;AACF,CAAC;"}