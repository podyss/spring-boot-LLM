{"version":3,"file":"index.js","sources":["../../src/components/layout/index.tsx"],"sourcesContent":["import { CSSProperties, defineComponent, h, isVNode, PropType, reactive } from 'vue';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/layout/constants';\nimport '@douyinfe/semi-foundation/layout/layout.scss';\nimport LayoutContext, { ContextType } from './layoutContext';\nimport Sider from './Sider';\nimport { CombineProps } from '../interface';\n\nconst htmlTag = {\n  Header: 'header',\n  Footer: 'footer',\n  Content: 'main',\n  Layout: 'section',\n};\n\nexport interface BasicProps {\n  prefixCls?: string;\n  style?: CSSProperties;\n  className?: string;\n  tagName?: keyof HTMLElementTagNameMap;\n  type?: string;\n}\n\nconst basicVuePropsType: CombineProps<BasicProps> = {\n  prefixCls: {\n    type: String,\n    default: cssClasses.PREFIX,\n  },\n  style: [String, Object] as PropType<BasicProps['style']>,\n  className: String,\n  tagName: String as PropType<BasicProps['tagName']>,\n  type: String,\n};\n\nconst Basic = defineComponent({\n  props: { ...basicVuePropsType },\n  name: 'Basic',\n  setup(props, { slots }) {\n    return () => {\n      const { prefixCls, type, className, tagName, ...others } = props;\n      const classString = cls(className, `${prefixCls}-${type}`);\n      return h(tagName, { className: classString, ...others }, slots.default ? slots.default() : null);\n    };\n  },\n});\n\nfunction generator<P extends { type?: string; tagName?: string; role?: any; 'aria-label'?: string }>(type: string) {\n  const tagName = htmlTag[type];\n  const typeName = type.toLowerCase();\n  return (BasicComponent) =>\n    defineComponent((props, { slots }) => {\n      return () => (\n        <BasicComponent role={props.role} aria-label={props['aria-label']} type={typeName} tagName={tagName} {...props}>\n          {slots.default ? slots.default() : null}\n        </BasicComponent>\n      );\n    });\n}\n\nconst LayoutHeader = generator<BasicProps>('Header')(Basic);\nconst LayoutFooter = generator<BasicProps>('Footer')(Basic);\nconst LayoutContent = generator<BasicProps>('Content')(Basic);\nconst LayoutSider = Sider;\n\nexport interface BasicLayoutProps {\n  prefixCls?: string;\n  style?: CSSProperties;\n  className?: string;\n  hasSider?: boolean;\n  tagName?: keyof HTMLElementTagNameMap;\n}\n\nexport interface BasicLayoutState {\n  siders: Array<string>;\n}\nexport const vuePropsType: CombineProps<BasicLayoutProps> = {\n  prefixCls: {\n    type: String,\n    default: cssClasses.PREFIX,\n  },\n  style: [String, Object] as PropType<BasicLayoutProps['style']>,\n  className: String,\n  hasSider: Boolean,\n  tagName: {\n    type: String as PropType<BasicLayoutProps['tagName']>,\n    default: 'section',\n  },\n};\nconst Layout = defineComponent({\n  props: { ...vuePropsType },\n  name: 'Layout',\n  setup(props, { slots }) {\n    const state = reactive<BasicLayoutState>({\n      siders: [],\n    });\n\n    function getSiderHook(): ContextType['siderHook'] {\n      return {\n        addSider: (id: string): void => {\n          state.siders = [...state.siders, id];\n        },\n        removeSider: (id: string): void => {\n          state.siders = state.siders.filter((curr) => curr !== id);\n        },\n      };\n    }\n\n    return () => {\n      const children = slots.default?.() || [];\n      const { prefixCls, className, hasSider, tagName, ...others } = props;\n      const { siders } = state;\n      const classString = cls(className, prefixCls, {\n        [`${prefixCls}-has-sider`]:\n          (typeof hasSider === 'boolean' && hasSider) ||\n          siders.length > 0 ||\n          children.some((child) => {\n            return isVNode(child) && child.type && (child.type as any).name === 'Layout.Sider';\n          }),\n      });\n      const Tag: any = tagName;\n      return (\n        <LayoutContext.Provider value={{ siderHook: getSiderHook() }}>\n          <Tag className={classString} {...others}>\n            {slots.default?.()}\n          </Tag>\n        </LayoutContext.Provider>\n      );\n    };\n  },\n});\n\nexport type LayoutType = typeof Layout & {\n  Header: typeof LayoutHeader;\n  Footer: typeof LayoutFooter;\n  Content: typeof LayoutContent;\n  Sider: typeof LayoutSider;\n};\nconst BaseLayout = Layout as LayoutType;\nBaseLayout.Header = LayoutHeader;\nBaseLayout.Footer = LayoutFooter;\nBaseLayout.Content = LayoutContent;\nBaseLayout.Sider = LayoutSider;\nexport { LayoutHeader, LayoutFooter, LayoutContent, LayoutSider };\nexport default BaseLayout;\n"],"names":["htmlTag","Header","Footer","Content","Layout","basicVuePropsType","prefixCls","type","String","default","cssClasses","PREFIX","style","Object","className","tagName","Basic","defineComponent","props","name","setup","slots","others","classString","cls","h","generator","typeName","toLowerCase","BasicComponent","_createVNode","_mergeProps","role","LayoutHeader","LayoutFooter","LayoutContent","LayoutSider","Sider","vuePropsType","hasSider","Boolean","state","reactive","siders","getSiderHook","addSider","id","removeSider","filter","curr","children","length","some","child","isVNode","Tag","LayoutContext","Provider","siderHook","BaseLayout"],"mappings":";;;;;;AAQA,MAAMA,IAAU;AAAA,EACdC,QAAQ;AAAA,EACRC,QAAQ;AAAA,EACRC,SAAS;AAAA,EACTC,QAAQ;AACV,GAUMC,IAA8C;AAAA,EAClDC,WAAW;AAAA,IACTC,MAAMC;AAAAA,IACNC,SAASC,EAAWC;AAAAA,EACrB;AAAA,EACDC,OAAO,CAACJ,QAAQK,MAAM;AAAA,EACtBC,WAAWN;AAAAA,EACXO,SAASP;AAAAA,EACTD,MAAMC;AACR,GAEMQ,IAAQC,gBAAAA,EAAgB;AAAA,EAC5BC,OAAO;AAAA,IAAE,GAAGb;AAAAA,EAAmB;AAAA,EAC/Bc,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,GAAG;AACtB,WAAO,MAAM;AACX,YAAM;AAAA,QAAEf,WAAAA;AAAAA,QAAWC,MAAAA;AAAAA,QAAMO,WAAAA;AAAAA,QAAWC,SAAAA;AAAAA,QAAS,GAAGO;AAAAA,MAAQ,IAAGJ,GACrDK,IAAcC,EAAIV,GAAW,GAAGR,CAAS,IAAIC,CAAI,EAAE;AACzD,aAAOkB,EAAEV,GAAS;AAAA,QAAED,WAAWS;AAAAA,QAAa,GAAGD;AAAAA,MAAO,GAAGD,EAAMZ,UAAUY,EAAMZ,QAAS,IAAG,IAAI;AAAA;EAEnG;AACF,CAAC;AAED,SAASiB,EAA4FnB,GAAc;AACjH,QAAMQ,IAAUf,EAAQO,CAAI,GACtBoB,IAAWpB,EAAKqB;AACtB,SAAQC,CAAAA,MACNZ,gBAAAA,EAAgB,CAACC,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,MACvB,MAAAS,EAAAD,GAAAE,EAAA;AAAA,IAAA,MACiBb,EAAMc;AAAAA,IAAI,cAAcd,EAAM,YAAY;AAAA,IAAC,MAAQS;AAAAA,IAAQ,SAAWZ;AAAAA,EAAO,GAAMG,CAAK,GAAA;AAAA,IAAAT,SAAAA,MAC3GY,CAAAA,EAAMZ,UAAUY,EAAMZ,QAAS,IAAG,IAAI;AAAA,GAE1C,CACF;AACL;AAEMwB,MAAAA,IAAeP,EAAsB,QAAQ,EAAEV,CAAK,GACpDkB,IAAeR,EAAsB,QAAQ,EAAEV,CAAK,GACpDmB,IAAgBT,EAAsB,SAAS,EAAEV,CAAK,GACtDoB,IAAcC,GAaPC,IAA+C;AAAA,EAC1DhC,WAAW;AAAA,IACTC,MAAMC;AAAAA,IACNC,SAASC,EAAWC;AAAAA,EACrB;AAAA,EACDC,OAAO,CAACJ,QAAQK,MAAM;AAAA,EACtBC,WAAWN;AAAAA,EACX+B,UAAUC;AAAAA,EACVzB,SAAS;AAAA,IACPR,MAAMC;AAAAA,IACNC,SAAS;AAAA,EACX;AACF,GACML,IAASa,gBAAAA,EAAgB;AAAA,EAC7BC,OAAO;AAAA,IAAE,GAAGoB;AAAAA,EAAc;AAAA,EAC1BnB,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,GAAG;AACtB,UAAMoB,IAAQC,EAA2B;AAAA,MACvCC,QAAQ,CAAA;AAAA,IACV,CAAC;AAED,aAASC,IAAyC;AAChD,aAAO;AAAA,QACLC,UAAWC,CAAAA,MAAqB;AAC9BL,UAAAA,EAAME,SAAS,CAAC,GAAGF,EAAME,QAAQG,CAAE;AAAA,QACpC;AAAA,QACDC,aAAcD,CAAAA,MAAqB;AACjCL,UAAAA,EAAME,SAASF,EAAME,OAAOK,OAAQC,CAAAA,MAASA,MAASH,CAAE;AAAA,QAC1D;AAAA;IAEJ;AAEA,WAAO,MAAM;;AACX,YAAMI,MAAW7B,IAAAA,EAAMZ,YAANY,gBAAAA,EAAAA,KAAAA,OAAqB,CAAA,GAChC;AAAA,QAAEf,WAAAA;AAAAA,QAAWQ,WAAAA;AAAAA,QAAWyB,UAAAA;AAAAA,QAAUxB,SAAAA;AAAAA,QAAS,GAAGO;AAAAA,MAAQ,IAAGJ,GACzD;AAAA,QAAEyB,QAAAA;AAAAA,MAAQ,IAAGF,GACblB,IAAcC,EAAIV,GAAWR,GAAW;AAAA,QAC5C,CAAC,GAAGA,CAAS,YAAY,GACtB,OAAOiC,KAAa,aAAaA,KAClCI,EAAOQ,SAAS,KAChBD,EAASE,KAAMC,CAAAA,MACNC,EAAQD,CAAK,KAAKA,EAAM9C,QAAS8C,EAAM9C,KAAaY,SAAS,cACrE;AAAA,MACL,CAAC,GACKoC,IAAWxC;AACjB,aAAAe,EAAA0B,EAAAC,UAAA;AAAA,QAAA,OACiC;AAAA,UAAEC,WAAWd,EAAa;AAAA,QAAE;AAAA,MAAC,GAAA;AAAA,QAAAnC,SAAAA,MAAA,CAAAqB,EAAAyB,GAAAxB,EAAA;AAAA,UAAA,WAC1CR;AAAAA,QAAW,GAAMD,CAAM,GAAA;AAAA,UAAAb,SAAAA,MAAA;;AAAA,qBACpCY,IAAAA,EAAMZ,YAANY,gBAAAA,EAAAA,KAAAA,EAAiB;AAAA;AAAA,QAAA,CAAA,CAAA;AAAA,MAAA,CAAA;AAAA;EAK5B;AACF,CAAC,GAQKsC,IAAavD;AACnBuD,EAAW1D,SAASgC;AACpB0B,EAAWzD,SAASgC;AACpByB,EAAWxD,UAAUgC;AACrBwB,EAAWtB,QAAQD;"}