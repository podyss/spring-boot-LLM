{"version":3,"file":"index.js","sources":["../../src/components/backtop/index.tsx"],"sourcesContent":["import cls from 'classnames';\nimport * as PropTypes from '../PropTypes';\nimport { throttle } from 'lodash';\nimport { cssClasses } from '@douyinfe/semi-foundation/backtop/constants';\nimport BackTopFoundation, { BackTopAdapter } from '@douyinfe/semi-foundation/backtop/foundation';\n\nimport '@douyinfe/semi-foundation/backtop/backtop.scss';\nimport IconButton from '../iconButton';\nimport { IconChevronUp } from '@kousum/semi-icons-vue';\nimport {\n  ComponentObjectPropsOptions,\n  CSSProperties,\n  defineComponent,\n  h,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  reactive,\n  useSlots,\n} from 'vue';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { useBaseComponent } from '../_base/baseComponent';\nimport { TabsProps } from '../tabs';\nimport { vuePropsMake } from '../PropTypes';\nimport { getFragmentChildren } from '../_utils';\n\nconst prefixCls = cssClasses.PREFIX;\n\nconst getDefaultTarget = () => window;\n\nexport interface BackTopProps {\n  target?: () => any;\n  visibilityHeight?: number;\n  duration?: number;\n  onClick?: (e: MouseEvent) => void;\n  style?: CSSProperties;\n  className?: string;\n}\n\nexport interface BackTopState {\n  visible?: boolean;\n}\n\nconst defaultProps = {\n  visibilityHeight: 400,\n  target: getDefaultTarget,\n  duration: 450,\n};\n\nconst propTypes: CombineProps<BackTopProps> = {\n  target: PropTypes.func as PropType<BackTopProps['target']>,\n  visibilityHeight: PropTypes.number,\n  duration: PropTypes.number,\n  onClick: PropTypes.func as PropType<BackTopProps['onClick']>,\n  style: PropTypes.object,\n  className: PropTypes.string,\n};\n\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\nconst BackTop = defineComponent({\n  props: { ...vuePropsType },\n  name: 'BackTop',\n  setup(props, {}) {\n    const slots = useSlots();\n\n    let handler: (e: MouseEvent) => void;\n    const state = reactive<BackTopState>({\n      visible: false,\n    });\n    const { adapter: adapterInject } = useBaseComponent<TabsProps>(props, state);\n    function adapter_(): BackTopAdapter {\n      return {\n        ...adapterInject(),\n        updateVisible: (visible: boolean) => {\n          state.visible = visible;\n        },\n        notifyClick: (e: MouseEvent) => {\n          props.onClick && props.onClick(e);\n        },\n        targetIsWindow: (target: any) => target === window,\n        isWindowUndefined: () => window === undefined,\n        targetScrollToTop: (targetNode: any, scrollTop: number) => {\n          if (targetNode === window) {\n            document.body.scrollTop = scrollTop;\n            document.documentElement.scrollTop = scrollTop;\n          } else {\n            targetNode.scrollTop = scrollTop;\n          }\n        },\n      };\n    }\n\n    const adapter = adapter_();\n    const foundation = new BackTopFoundation(adapter);\n\n    onMounted(() => {\n      foundation.init();\n      handler = throttle(handleClick, props.duration ?? defaultProps.duration);\n    });\n\n    onBeforeUnmount(() => {\n      foundation.destroy();\n    });\n\n    function handleClick(e: MouseEvent) {\n      foundation.onClick(e);\n    }\n\n    function renderDefault() {\n      return <IconButton theme=\"light\" icon={<IconChevronUp />} />;\n    }\n\n    return () => {\n      const children = getFragmentChildren(slots);\n      const { className, style, onClick, visibilityHeight, target, ...others } = props;\n      const { visible } = state;\n      const preCls = cls(prefixCls, className);\n      const backtopBtn = children ? children : renderDefault();\n      const content = visible ? (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/no-static-element-interactions\n        <div {...others} class={preCls} style={style} onClick={(e) => handler(e)} x-semi-prop=\"children\">\n          {backtopBtn}\n        </div>\n      ) : null;\n      return content;\n    };\n  },\n});\n\nexport default BackTop;\n"],"names":["prefixCls","cssClasses","PREFIX","getDefaultTarget","window","defaultProps","visibilityHeight","target","duration","propTypes","PropTypes","func","number","onClick","style","object","className","string","vuePropsType","vuePropsMake","BackTop","defineComponent","props","name","setup","slots","useSlots","handler","state","reactive","visible","adapter","adapterInject","useBaseComponent","adapter_","updateVisible","notifyClick","e","targetIsWindow","isWindowUndefined","undefined","targetScrollToTop","targetNode","scrollTop","document","body","documentElement","foundation","BackTopFoundation","onMounted","init","throttle","handleClick","onBeforeUnmount","destroy","renderDefault","_createVNode","IconButton","IconChevronUp","children","getFragmentChildren","others","preCls","cls","backtopBtn","_mergeProps"],"mappings":";;;;;;;;;;;;AA0BA,MAAMA,IAAYC,EAAWC,QAEvBC,IAAmBA,MAAMC,QAezBC,IAAe;AAAA,EACnBC,kBAAkB;AAAA,EAClBC,QAAQJ;AAAAA,EACRK,UAAU;AACZ,GAEMC,IAAwC;AAAA,EAC5CF,QAAQG,EAAUC;AAAAA,EAClBL,kBAAkBI,EAAUE;AAAAA,EAC5BJ,UAAUE,EAAUE;AAAAA,EACpBC,SAASH,EAAUC;AAAAA,EACnBG,OAAOJ,EAAUK;AAAAA,EACjBC,WAAWN,EAAUO;AACvB,GAEaC,IAAeC,EAAaV,GAAWJ,CAAY,GAC1De,KAAUC,gBAAAA,EAAgB;AAAA,EAC9BC,OAAO;AAAA,IAAE,GAAGJ;AAAAA,EAAc;AAAA,EAC1BK,MAAM;AAAA,EACNC,MAAMF,GAAO,IAAI;AACf,UAAMG,IAAQC;AAEd,QAAIC;AACJ,UAAMC,IAAQC,EAAuB;AAAA,MACnCC,SAAS;AAAA,IACX,CAAC,GACK;AAAA,MAAEC,SAASC;AAAAA,IAAc,IAAIC,EAA4BX,GAAOM,CAAK;AAC3E,aAASM,IAA2B;AAClC,aAAO;AAAA,QACL,GAAGF,EAAe;AAAA,QAClBG,eAAgBL,CAAAA,MAAqB;AACnCF,UAAAA,EAAME,UAAUA;AAAAA,QACjB;AAAA,QACDM,aAAcC,CAAAA,MAAkB;AAC9Bf,UAAAA,EAAMT,WAAWS,EAAMT,QAAQwB,CAAC;AAAA,QACjC;AAAA,QACDC,gBAAiB/B,CAAAA,MAAgBA,MAAWH;AAAAA,QAC5CmC,mBAAmBA,MAAMnC,WAAWoC;AAAAA,QACpCC,mBAAmBA,CAACC,GAAiBC,MAAsB;AACzD,UAAID,MAAetC,UACjBwC,SAASC,KAAKF,YAAYA,GAC1BC,SAASE,gBAAgBH,YAAYA,KAErCD,EAAWC,YAAYA;AAAAA,QAE3B;AAAA;IAEJ;AAEA,UAAMZ,IAAUG,KACVa,IAAa,IAAIC,EAAkBjB,CAAO;AAEhDkB,IAAAA,EAAU,MAAM;AACdF,MAAAA,EAAWG,KAAI,GACfvB,IAAUwB,EAASC,GAAa9B,EAAMd,YAAYH,EAAaG,QAAQ;AAAA,IACzE,CAAC,GAED6C,EAAgB,MAAM;AACpBN,MAAAA,EAAWO,QAAO;AAAA,IACpB,CAAC;AAED,aAASF,EAAYf,GAAe;AAClCU,MAAAA,EAAWlC,QAAQwB,CAAC;AAAA,IACtB;AAEA,aAASkB,IAAgB;AACvB,aAAAC,EAAAC,GAAA;AAAA,QAAA,OAAA;AAAA,QAAA,MAAAD,EAAAE,GAAA,MAAA,IAAA;AAAA,MAAA,GAAA,IAAA;AAAA,IACF;AAEA,WAAO,MAAM;AACX,YAAMC,IAAWC,EAAoBnC,CAAK,GACpC;AAAA,QAAET,WAAAA;AAAAA,QAAWF,OAAAA;AAAAA,QAAOD,SAAAA;AAAAA,QAASP,kBAAAA;AAAAA,QAAkBC,QAAAA;AAAAA,QAAQ,GAAGsD;AAAAA,MAAQ,IAAGvC,GACrE;AAAA,QAAEQ,SAAAA;AAAAA,MAAS,IAAGF,GACdkC,IAASC,EAAI/D,GAAWgB,CAAS,GACjCgD,IAAaL,KAAsBJ,EAAa;AAOtD,aANgBzB;AAAAA;AAAAA,QACd0B,EAAA,OAAAS,EACSJ,GAAM;AAAA,UAAA,OAASC;AAAAA,UAAM,OAAShD;AAAAA,UAAK,SAAYuB,CAAAA,MAAMV,EAAQU,CAAC;AAAA,UAAC,eAAA;AAAA,QACrE2B,CAAAA,GAAAA,CAAAA,CAAU;UAEX;AAAA;EAGR;AACF,CAAC;"}