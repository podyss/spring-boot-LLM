{"version":3,"file":"option.js","sources":["../../src/components/select/option.tsx"],"sourcesContent":["import { type ComponentObjectPropsOptions, type CSSProperties, defineComponent, h, type PropType, toRaw, type VNode } from 'vue';\nimport classNames from 'classnames';\n\nimport { isString } from 'lodash';\nimport { cssClasses } from '@douyinfe/semi-foundation/select/constants';\nimport { LocaleConsumerFunc } from '../locale/localeConsumer';\nimport { IconTick } from '@kousum/semi-icons-vue';\nimport { getHighLightTextHTML } from '../_utils/index';\nimport type { Locale } from '../locale/interface';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport type { BasicOptionProps } from '@douyinfe/semi-foundation/select/optionFoundation';\nimport type { CombineProps, RemoveIndexSignature } from '../interface';\nimport { OptionGroupProps } from './optionGroup';\nimport { useHasInProps } from '../_base/baseComponent';\n\nconst LocaleConsumer = LocaleConsumerFunc<Locale['Select']>();\n\nexport interface OptionProps extends RemoveIndexSignature<BasicOptionProps> {\n  value?: string | number;\n  label?: string | number | VNode | VNode[];\n  children?: string | number | VNode | VNode[];\n  disabled?: boolean;\n  showTick?: boolean;\n  className?: string;\n  style?: CSSProperties;\n\n  //官方暂时还没有的类型\n  selected?: boolean\n  empty?: boolean,\n  emptyContent?: string | number | VNode | VNode[] | (()=>VNode),\n  inputValue?: string\n  renderOptionItem?: (...args: any)=>VNode\n  onMouseEnter?:  (e: MouseEvent) => any,\n  focused?: boolean,\n  onSelect?:  (opts: OptionProps, e: MouseEvent) => any,\n  prefixCls?: string,\n  _scrollIndex?: number,\n  _selected?: boolean,\n  _show?: boolean,\n  semiOptionId?: string,\n  key_?: any,\n  _parentGroup?: OptionGroupProps,\n  _keyInOptionList?: string,\n  _keyInJsx?: string | number,\n  _inputCreateOnly?: boolean,\n\n  optionRest?: Record<string, any>\n}\n\ninterface renderOptionContentArgument {\n  config: {\n    searchWords: any;\n    sourceString: string | number | VNode | VNode[];\n  };\n  children: string | number | VNode | VNode[];\n  inputValue: string;\n  prefixCls: string;\n}\n\nexport const vuePropsType: CombineProps<OptionProps> = {\n  value: [String, Number],\n  label: [String, Number, Object, Array],\n  children: [String, Number, Object, Array],\n  disabled: Boolean,\n  selected: Boolean,\n\n  empty: Boolean,\n  emptyContent: [Object, String, Number, Function] as PropType<OptionProps['emptyContent']>,\n  inputValue: String,\n  renderOptionItem: Function as PropType<OptionProps['renderOptionItem']>,\n  onMouseEnter: Function as PropType<OptionProps['onMouseEnter']>,\n  focused: Boolean,\n\n  showTick: Boolean,\n  className: String,\n  style: [String, Object] as PropType<OptionProps['style']>,\n  onSelect: Function as PropType<OptionProps['onSelect']>,\n  prefixCls: {\n    type: String,\n    default: cssClasses.PREFIX_OPTION,\n  },\n  _scrollIndex: Number,\n  _selected: Boolean,\n  _show: Boolean,\n  semiOptionId: String,\n  key_: [Object, String, Number],\n  _parentGroup: Object,\n  _keyInOptionList: String,\n  _keyInJsx: [String, Number],\n  _inputCreateOnly: Boolean,\n\n  optionRest: {\n    type: Object,\n    default: () => {}\n  }\n};\n\nconst Option = defineComponent({\n  props: { ...vuePropsType },\n  name: 'isSelectOption',\n  setup(props, { slots, attrs }) {\n    const {getProps} = useHasInProps()\n    function onClick({ value, label, children, ...rest }: Partial<OptionProps>, event: MouseEvent) {\n      const isDisabled = props.disabled;\n      if (!isDisabled) {\n        props.onSelect({ ...rest, value, label: toRaw(label || children) }, event);\n      }\n    }\n\n    function renderOptionContent({ config, children, inputValue, prefixCls }: renderOptionContentArgument) {\n      if (isString(children) && inputValue) {\n        return getHighLightTextHTML(config as any);\n      }\n      return children;\n    }\n\n    return () => {\n      const children = slots.default ? slots.default() : null;\n      // 还有部分属性没有写到props\n      const {\n        disabled,\n        value,\n        selected,\n        label,\n        empty,\n        emptyContent,\n        onSelect,\n        focused,\n        showTick,\n        className,\n        style,\n        onMouseEnter,\n        prefixCls,\n        renderOptionItem,\n        inputValue,\n        semiOptionId,\n        optionRest,\n        ...rest_\n      } = getProps(props);\n      const rest = {...props.optionRest, ...rest_}\n      const optionClassName = classNames(prefixCls, {\n        [`${prefixCls}-disabled`]: disabled,\n        [`${prefixCls}-selected`]: selected,\n        [`${prefixCls}-focused`]: focused,\n        [`${prefixCls}-empty`]: empty,\n        [className]: className,\n      });\n      const selectedIconClassName = classNames([`${prefixCls}-icon`]);\n\n      if (empty) {\n        if (emptyContent === null) {\n          return null;\n        }\n        return (\n          <LocaleConsumer componentName=\"Select\">\n            {(locale: Locale['Select']) => <div class={optionClassName}>{emptyContent || locale.emptyText}</div>}\n          </LocaleConsumer>\n        );\n      }\n\n      // Since there are empty, locale and other logic, the custom renderOptionItem is directly converged to the internal option instead of being placed in Select/index\n      if (typeof renderOptionItem === 'function') {\n        const customRenderClassName = classNames(className,\n          {\n            [`${prefixCls}-custom`]: true,\n            [`${prefixCls}-custom-selected`]: selected\n          }\n        );\n        return renderOptionItem({\n          disabled,\n          focused,\n          selected,\n          style,\n          label,\n          value,\n          inputValue,\n          onMouseEnter: (e: MouseEvent) => onMouseEnter(e),\n          onClick: (e: MouseEvent) => onClick({ value, label, children, ...rest }, e),\n          className: customRenderClassName,\n          ...rest,\n        });\n      }\n\n      const config = {\n        searchWords: inputValue,\n        sourceString: children,\n        option: {\n          highlightClassName: `${prefixCls}-keyword`,\n        },\n      };\n      return (\n        // eslint-disable-next-line jsx-a11y/interactive-supports-focus,jsx-a11y/click-events-have-key-events\n        <div\n          class={optionClassName}\n          onClick={(e) => {\n            onClick({ value, label, children, ...rest }, e);\n          }}\n          onMouseenter={(e) => onMouseEnter && onMouseEnter(e)}\n          role=\"option\"\n          id={semiOptionId}\n          aria-selected={selected ? 'true' : 'false'}\n          aria-disabled={disabled ? 'true' : 'false'}\n          style={style}\n          {...getDataAttr(attrs)}\n        >\n          {showTick ? (\n            <div class={selectedIconClassName}>\n              <IconTick />\n            </div>\n          ) : null}\n          {isString(children) ? (\n            <div class={`${prefixCls}-text`}>{renderOptionContent({ children, config, inputValue, prefixCls })}</div>\n          ) : (\n            [children]\n          )}\n        </div>\n      );\n    };\n  },\n});\n\nexport default Option;\n"],"names":["LocaleConsumer","LocaleConsumerFunc","vuePropsType","value","String","Number","label","Object","Array","children","disabled","Boolean","selected","empty","emptyContent","Function","inputValue","renderOptionItem","onMouseEnter","focused","showTick","className","style","onSelect","prefixCls","type","default","cssClasses","PREFIX_OPTION","_scrollIndex","_selected","_show","semiOptionId","key_","_parentGroup","_keyInOptionList","_keyInJsx","_inputCreateOnly","optionRest","Option","defineComponent","props","name","setup","slots","attrs","getProps","useHasInProps","onClick","rest","event","toRaw","renderOptionContent","config","isString","getHighLightTextHTML","rest_","optionClassName","classNames","selectedIconClassName","_createVNode","locale","emptyText","customRenderClassName","e","searchWords","sourceString","option","highlightClassName","_mergeProps","getDataAttr","IconTick"],"mappings":";;;;;;;;;AAeA,MAAMA,IAAiBC,EAAkB,GA4C5BC,IAA0C;AAAA,EACrDC,OAAO,CAACC,QAAQC,MAAM;AAAA,EACtBC,OAAO,CAACF,QAAQC,QAAQE,QAAQC,KAAK;AAAA,EACrCC,UAAU,CAACL,QAAQC,QAAQE,QAAQC,KAAK;AAAA,EACxCE,UAAUC;AAAAA,EACVC,UAAUD;AAAAA,EAEVE,OAAOF;AAAAA,EACPG,cAAc,CAACP,QAAQH,QAAQC,QAAQU,QAAQ;AAAA,EAC/CC,YAAYZ;AAAAA,EACZa,kBAAkBF;AAAAA,EAClBG,cAAcH;AAAAA,EACdI,SAASR;AAAAA,EAETS,UAAUT;AAAAA,EACVU,WAAWjB;AAAAA,EACXkB,OAAO,CAAClB,QAAQG,MAAM;AAAA,EACtBgB,UAAUR;AAAAA,EACVS,WAAW;AAAA,IACTC,MAAMrB;AAAAA,IACNsB,SAASC,EAAWC;AAAAA,EACrB;AAAA,EACDC,cAAcxB;AAAAA,EACdyB,WAAWnB;AAAAA,EACXoB,OAAOpB;AAAAA,EACPqB,cAAc5B;AAAAA,EACd6B,MAAM,CAAC1B,QAAQH,QAAQC,MAAM;AAAA,EAC7B6B,cAAc3B;AAAAA,EACd4B,kBAAkB/B;AAAAA,EAClBgC,WAAW,CAAChC,QAAQC,MAAM;AAAA,EAC1BgC,kBAAkB1B;AAAAA,EAElB2B,YAAY;AAAA,IACVb,MAAMlB;AAAAA,IACNmB,SAASA,MAAM;AAAA,IAAC;AAAA,EAClB;AACF,GAEMa,KAASC,gBAAAA,EAAgB;AAAA,EAC7BC,OAAO;AAAA,IAAE,GAAGvC;AAAAA,EAAc;AAAA,EAC1BwC,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,IAAOC,OAAAA;AAAAA,EAAM,GAAG;AAC7B,UAAM;AAAA,MAACC,UAAAA;AAAAA,IAAS,IAAGC,EAAa;AAChC,aAASC,EAAQ;AAAA,MAAE7C,OAAAA;AAAAA,MAAOG,OAAAA;AAAAA,MAAOG,UAAAA;AAAAA,MAAU,GAAGwC;AAAAA,IAA4B,GAAEC,GAAmB;AAE7F,MADmBT,EAAM/B,YAEvB+B,EAAMlB,SAAS;AAAA,QAAE,GAAG0B;AAAAA,QAAM9C,OAAAA;AAAAA,QAAOG,OAAO6C,EAAM7C,KAASG,CAAQ;AAAA,MAAG,GAAEyC,CAAK;AAAA,IAE7E;AAEA,aAASE,EAAoB;AAAA,MAAEC,QAAAA;AAAAA,MAAQ5C,UAAAA;AAAAA,MAAUO,YAAAA;AAAAA,MAAYQ,WAAAA;AAAAA,IAAuC,GAAG;AACrG,aAAI8B,EAAS7C,CAAQ,KAAKO,IACjBuC,EAAqBF,CAAa,IAEpC5C;AAAAA,IACT;AAEA,WAAO,MAAM;AACX,YAAMA,IAAWmC,EAAMlB,UAAUkB,EAAMlB,QAAS,IAAG,MAE7C;AAAA,QACJhB,UAAAA;AAAAA,QACAP,OAAAA;AAAAA,QACAS,UAAAA;AAAAA,QACAN,OAAAA;AAAAA,QACAO,OAAAA;AAAAA,QACAC,cAAAA;AAAAA,QACAS,UAAAA;AAAAA,QACAJ,SAAAA;AAAAA,QACAC,UAAAA;AAAAA,QACAC,WAAAA;AAAAA,QACAC,OAAAA;AAAAA,QACAJ,cAAAA;AAAAA,QACAM,WAAAA;AAAAA,QACAP,kBAAAA;AAAAA,QACAD,YAAAA;AAAAA,QACAgB,cAAAA;AAAAA,QACAM,YAAAA;AAAAA,QACA,GAAGkB;AAAAA,MACL,IAAIV,EAASL,CAAK,GACZQ,IAAO;AAAA,QAAC,GAAGR,EAAMH;AAAAA,QAAY,GAAGkB;AAAAA,SAChCC,IAAkBC,EAAWlC,GAAW;AAAA,QAC5C,CAAC,GAAGA,CAAS,WAAW,GAAGd;AAAAA,QAC3B,CAAC,GAAGc,CAAS,WAAW,GAAGZ;AAAAA,QAC3B,CAAC,GAAGY,CAAS,UAAU,GAAGL;AAAAA,QAC1B,CAAC,GAAGK,CAAS,QAAQ,GAAGX;AAAAA,QACxB,CAACQ,CAAS,GAAGA;AAAAA,MACf,CAAC,GACKsC,IAAwBD,EAAW,CAAC,GAAGlC,CAAS,OAAO,CAAC;AAE9D,UAAIX;AACF,eAAIC,MAAiB,OACZ,OAET8C,EAAA5D,GAAA;AAAA,UAAA,eAAA;AAAA,QAAA,GAAA;AAAA,UAAA0B,SAEMmC,CAAAA,MAAwBD,EAAA,OAAA;AAAA,YAAA,OAAiBH;AAAAA,UAAe,GAAA,CAAG3C,KAAgB+C,EAAOC,SAAS,CAAA;AAAA,QAAO,CAAA;AAM1G,UAAI,OAAO7C,KAAqB,YAAY;AAC1C,cAAM8C,IAAwBL,EAAWrC,GACvC;AAAA,UACE,CAAC,GAAGG,CAAS,SAAS,GAAG;AAAA,UACzB,CAAC,GAAGA,CAAS,kBAAkB,GAAGZ;AAAAA,QACpC,CACF;AACA,eAAOK,EAAiB;AAAA,UACtBP,UAAAA;AAAAA,UACAS,SAAAA;AAAAA,UACAP,UAAAA;AAAAA,UACAU,OAAAA;AAAAA,UACAhB,OAAAA;AAAAA,UACAH,OAAAA;AAAAA,UACAa,YAAAA;AAAAA,UACAE,cAAe8C,CAAAA,MAAkB9C,EAAa8C,CAAC;AAAA,UAC/ChB,SAAUgB,CAAAA,MAAkBhB,EAAQ;AAAA,YAAE7C,OAAAA;AAAAA,YAAOG,OAAAA;AAAAA,YAAOG,UAAAA;AAAAA,YAAU,GAAGwC;AAAAA,UAAM,GAAEe,CAAC;AAAA,UAC1E3C,WAAW0C;AAAAA,UACX,GAAGd;AAAAA,QACL,CAAC;AAAA,MACH;AAEA,YAAMI,IAAS;AAAA,QACbY,aAAajD;AAAAA,QACbkD,cAAczD;AAAAA,QACd0D,QAAQ;AAAA,UACNC,oBAAoB,GAAG5C,CAAS;AAAA,QAClC;AAAA;AAEF;AAAA;AAAA,QACEoC,SAAAS,EAAA;AAAA,UAAA,OAESZ;AAAAA,UAAe,SACZO,CAAAA,MAAM;AACdhB,YAAAA,EAAQ;AAAA,cAAE7C,OAAAA;AAAAA,cAAOG,OAAAA;AAAAA,cAAOG,UAAAA;AAAAA,cAAU,GAAGwC;AAAAA,YAAM,GAAEe,CAAC;AAAA,UAC/C;AAAA,UAAA,cACcA,CAAAA,MAAM9C,KAAgBA,EAAa8C,CAAC;AAAA,UAAC,MAAA;AAAA,UAAA,IAEhDhC;AAAAA,UAAY,iBACDpB,IAAW,SAAS;AAAA,UAAO,iBAC3BF,IAAW,SAAS;AAAA,UAAO,OACnCY;AAAAA,QAAK,GACRgD,EAAYzB,CAAK,CAAC,GAErBzB,CAAAA,IAAQwC,EAAA,OAAA;AAAA,UAAA,OACKD;AAAAA,QAAqBC,GAAAA,CAAAA,EAAAW,GAG/B,MAAA,IAAA,CAAA,CAAA,IAAA,MACHjB,EAAS7C,CAAQ,IAACmD,EAAA,OAAA;AAAA,UAAA,OACL,GAAGpC,CAAS;AAAA,QAAO,GAAA,CAAG4B,EAAoB;AAAA,UAAE3C,UAAAA;AAAAA,UAAU4C,QAAAA;AAAAA,UAAQrC,YAAAA;AAAAA,UAAYQ,WAAAA;AAAAA,QAAW,CAAA,CAAC,CAAA,IAElG,CAACf,CAAQ,CACV,CAAA;AAAA;AAAA;EAIT;AACF,CAAC;"}