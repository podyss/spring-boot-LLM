{"version":3,"file":"index.js","sources":["../../src/components/list/index.tsx"],"sourcesContent":["import cls from 'classnames';\nimport * as PropTypes from '../PropTypes';\nimport { cssClasses, strings } from '@douyinfe/semi-foundation/list/constants';\nimport { noop } from 'lodash';\nimport '@douyinfe/semi-foundation/list/list.scss';\nimport LocaleConsumer from '../locale/localeConsumer';\nimport { Locale } from '../locale/interface';\nimport ListItem from './item';\nimport { Row } from '../grid';\nimport Spin from '../spin';\nimport ListContext, { Grid } from './list-context';\nimport {\n  cloneVNode,\n  ComponentObjectPropsOptions,\n  CSSProperties,\n  defineComponent,\n  h,\n  PropType,\n  useSlots,\n  VNode,\n} from 'vue';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { vuePropsMake } from '../PropTypes';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport { useAttrs } from 'vue';\n\nexport type { ListItemProps } from './item';\n\nexport interface ListProps<T> {\n  style?: CSSProperties;\n  className?: string;\n  bordered?: boolean;\n  footer?: VueJsxNode;\n  header?: VueJsxNode;\n  layout?: 'vertical' | 'horizontal';\n  size?: 'small' | 'large' | 'default';\n  split?: boolean;\n  emptyContent?: VueJsxNode;\n  dataSource?: T[];\n  renderItem?: (item: T, ind: number) => VNode;\n  grid?: Grid;\n  loading?: boolean;\n  loadMore?: VueJsxNode;\n  onClick?: (e: MouseEvent) => void;\n  onRightClick?: (e: MouseEvent) => void;\n}\n\nconst prefixCls = cssClasses.PREFIX;\n\n\nexport function List_<T>(){\n\n  const propTypes: CombineProps<ListProps<T>> = {\n    style: PropTypes.object,\n    className: PropTypes.string,\n    bordered: PropTypes.bool,\n    footer: PropTypes.node,\n    header: PropTypes.node,\n    layout: PropTypes.string as PropType<ListProps<T>['layout']>,\n    size: PropTypes.string as PropType<ListProps<T>['size']>,\n    split: PropTypes.bool,\n    emptyContent: PropTypes.node,\n    dataSource: PropTypes.array,\n    renderItem: PropTypes.func as PropType<ListProps<T>['renderItem']>,\n    grid: PropTypes.object,\n    loading: PropTypes.bool,\n    loadMore: PropTypes.node,\n    onRightClick: PropTypes.func as PropType<ListProps<T>['onRightClick']>,\n    onClick: PropTypes.func as PropType<ListProps<T>['onClick']>,\n  };\n\n  const defaultProps = {\n    bordered: false,\n    split: true,\n    loading: false,\n    layout: 'vertical',\n    size: 'default',\n    onRightClick: noop,\n    onClick: noop,\n  };\n  const vuePropsType = vuePropsMake(propTypes, defaultProps);\n  return  defineComponent({\n    props: { ...vuePropsType },\n    name: 'List',\n    setup(props, {}) {\n      const slots = useSlots();\n      const attr = useAttrs();\n\n      const renderEmpty = () => {\n        const { emptyContent } = props;\n        if (emptyContent) {\n          return (\n            <div class={`${cssClasses.PREFIX}-empty`} x-semi-prop=\"emptyContent\">\n              {emptyContent}\n            </div>\n          );\n        } else {\n          return (\n            <LocaleConsumer componentName=\"List\">\n              {(locale: Locale['List']) => <div class={`${cssClasses.PREFIX}-empty`}>{locale.emptyText}</div>}\n            </LocaleConsumer>\n          );\n        }\n      };\n\n      function wrapChildren(childrenList: VNode[], children: VNode[]) {\n        const { grid } = props;\n        if (grid) {\n          const rowProps = {};\n          ['align', 'gutter', 'justify', 'type'].forEach((key) => {\n            if (key in grid) {\n              rowProps[key] = grid[key];\n            }\n          });\n          return (\n            <Row type=\"flex\" {...rowProps}>\n              {childrenList ? childrenList : null}\n              {children}\n            </Row>\n          );\n        }\n        return (\n          <ul class={`${prefixCls}-items`}>\n            {childrenList ? childrenList : null}\n            {children}\n          </ul>\n        );\n      }\n\n      return () => {\n        const children = slots.default?.();\n        const {\n          style,\n          className,\n          header,\n          loading,\n          onRightClick,\n          onClick,\n          footer,\n          layout,\n          grid,\n          size,\n          split,\n          loadMore,\n          bordered,\n          dataSource,\n          renderItem,\n          ...rest\n        } = props;\n        const wrapperCls = cls(prefixCls, className, {\n          [`${prefixCls}-flex`]: layout === 'horizontal',\n          [`${prefixCls}-${size}`]: size,\n          [`${prefixCls}-grid`]: grid,\n          [`${prefixCls}-split`]: split,\n          [`${prefixCls}-bordered`]: bordered,\n        });\n        let childrenList;\n        if (dataSource && dataSource.length) {\n          childrenList = [];\n          const items = renderItem ? dataSource.map((item, index) => renderItem(item, index)) : [];\n          items.forEach((child, index) => {\n            const itemKey = child.key || `list-item-${index}`;\n            childrenList.push(\n              cloneVNode(child, {\n                key: itemKey,\n              })\n            );\n          });\n        } else if (!children && !loading) {\n          childrenList = renderEmpty();\n        }\n        return (\n          <div class={wrapperCls} style={style} {...getDataAttr({ ...rest, ...attr })}>\n            {header ? (\n              <div class={`${cssClasses.PREFIX}-header`} x-semi-prop=\"header\">\n                {header}\n              </div>\n            ) : null}\n            <ListContext.Provider\n              value={{\n                grid,\n                onRightClick,\n                onClick,\n              }}\n            >\n              <Spin spinning={loading} size=\"large\">\n                {wrapChildren(childrenList, children)}\n              </Spin>\n            </ListContext.Provider>\n            {footer ? (\n              <div class={`${cssClasses.PREFIX}-footer`} x-semi-prop=\"footer\">\n                {footer}\n              </div>\n            ) : null}\n            {loadMore ? loadMore : null}\n          </div>\n        );\n      };\n    },\n  });\n}\nconst List = List_()\nexport type ListType = typeof List & {\n  Item: typeof ListItem\n}\nconst BaseList = List as ListType\nBaseList.Item = ListItem\nexport default BaseList;\nexport { ListItem };\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","prefixCls","cssClasses","PREFIX","List_","propTypes","style","PropTypes","object","className","string","bordered","bool","footer","node","header","layout","size","split","emptyContent","dataSource","array","renderItem","func","grid","loading","loadMore","onRightClick","onClick","vuePropsType","vuePropsMake","noop","props","name","setup","slots","useSlots","attr","useAttrs","renderEmpty","_createVNode","LocaleConsumer","default","locale","emptyText","wrapChildren","childrenList","children","rowProps","forEach","key","Row","_mergeProps","_slot","rest","wrapperCls","cls","length","map","item","index","child","itemKey","push","cloneVNode","getDataAttr","ListContext","Provider","Spin","List","BaseList","Item","ListItem"],"mappings":"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"}