{"version":3,"file":"index.js","sources":["../../src/components/_utils/index.tsx"],"sourcesContent":["/* eslint-disable max-len */\n/* argus-disable unPkgSensitiveInfo */\nimport { cloneDeepWith, get, set } from 'lodash';\nimport warning from '@douyinfe/semi-foundation/utils/warning';\nimport { findAll } from '@douyinfe/semi-foundation/utils/getHighlight';\nimport type { SetupContext } from 'vue';\nimport { h, isVNode, VNode } from 'vue';\nimport { isHTMLElement } from '@douyinfe/semi-foundation/utils/dom';\n\n/**\n * stop propagation\n *\n * @param e\n * @param {boolean} noImmediate Skip stopping immediate propagation\n */\nexport function stopPropagation(e: any, noImmediate?: boolean) {\n    if (e && typeof e.stopPropagation === 'function') {\n        e.stopPropagation();\n    }\n\n    if (!noImmediate && e && typeof e.stopImmediatePropagation === 'function') {\n        e.stopImmediatePropagation();\n    }\n}\n\n/**\n * use in Table, Form, Navigation\n *\n * skip clone function and react element\n */\nexport function cloneDeep<T>(value: T): T;\nexport function cloneDeep<T>(value: T, customizer: (value: any) => any): any;\nexport function cloneDeep(value: any, customizer?: (value: any) => any) {\n    return cloneDeepWith(value, v => {\n        if (typeof customizer === 'function') {\n            return customizer(v);\n        }\n        if (typeof v === 'function' || isVNode(v)) {\n            return v;\n        }\n        if (Object.prototype.toString.call(v) === '[object Error]') {\n            return v;\n        }\n        // it is tricky\n        // when array length beyond max length, array.length will be 0\n        if (Array.isArray(v) && v.length === 0) {\n            const keys: string[] = Object.keys(v);\n            if (keys.length) {\n                const newArray: any[] = [];\n                keys.forEach(key => {\n                    // @ts-ignore\n                    set(newArray, key, v[key]);\n                });\n                // internal-issues:887\n                warning(\n                    get(process, 'env.NODE_ENV') !== 'production',\n                    `[Semi] You may use an out-of-bounds array. In some cases, your program may not behave as expected.\n                    The maximum length of an array is 4294967295.\n                    Please check whether the array subscript in your data exceeds the maximum value of the JS array subscript`\n                );\n                return newArray;\n            } else {\n                return undefined;\n            }\n        }\n        return undefined;\n    });\n}\n\n/**\n * [getHighLightTextHTML description]\n *\n * @param   {string} sourceString [source content text]\n * @param   {Array<string>} searchWords [keywords to be highlighted]\n * @param   {object} option\n * @param   {true}      option.highlightTag [The tag wrapped by the highlighted content, mark is used by default]\n * @param   {true}      option.highlightClassName\n * @param   {true}      option.highlightStyle\n * @param   {boolean}   option.caseSensitive\n *\n * @return  {Array<object>}\n */\nexport const getHighLightTextHTML = ({\n    sourceString = '',\n    searchWords = [],\n    option = { autoEscape: true, caseSensitive: false }\n}: GetHighLightTextHTMLProps) => {\n    const chunks: HighLightTextHTMLChunk[] = findAll({ sourceString, searchWords, ...option });\n    const markEle = option.highlightTag || 'mark';\n    const highlightClassName = option.highlightClassName || '';\n    const highlightStyle = option.highlightStyle || {};\n    return chunks.map((chunk: HighLightTextHTMLChunk) => {\n        const { end, start, highlight } = chunk;\n        const text = sourceString.substr(start, end - start);\n        if (highlight) {\n            return h(\n                markEle,\n                {\n                    style: highlightStyle,\n                    className: highlightClassName,\n                },\n                text\n            );\n        } else {\n            return text;\n        }\n    });\n};\n\nexport interface RegisterMediaQueryOption {\n    match?: (e: MediaQueryList | MediaQueryListEvent) => void;\n    unmatch?: (e: MediaQueryList | MediaQueryListEvent) => void;\n    callInInit?: boolean;\n}\n\n/**\n * register matchFn and unMatchFn callback while media query\n * @param {string} media media string\n * @param {object} param param object\n * @returns function\n */\nexport const registerMediaQuery = (media: string, { match, unmatch, callInInit = true }: RegisterMediaQueryOption): () => void => {\n    if (typeof window !== 'undefined') {\n        const mediaQueryList = window.matchMedia(media);\n        function handlerMediaChange(e: MediaQueryList | MediaQueryListEvent): void {\n            if (e.matches) {\n                match && match(e);\n            } else {\n                unmatch && unmatch(e);\n            }\n        }\n        callInInit && handlerMediaChange(mediaQueryList);\n        mediaQueryList.addEventListener('change', handlerMediaChange);\n        return (): void => mediaQueryList.removeEventListener('change', handlerMediaChange);\n    }\n    return null;\n};\nexport interface GetHighLightTextHTMLProps {\n    sourceString?: string;\n    searchWords?: any[];\n    option: HighLightTextHTMLOption;\n}\n\nexport interface HighLightTextHTMLOption {\n    highlightTag?: string;\n    highlightClassName?: string;\n    highlightStyle?: Record<string, any>;\n    caseSensitive: boolean;\n    autoEscape: boolean;\n}\n\nexport interface HighLightTextHTMLChunk {\n    start?: number;\n    end?: number;\n    highlight?: any;\n}\n\n/**\n * Determine whether the incoming element is a built-in icon\n * @param icon 元素\n * @returns boolean\n */\nexport const isSemiIcon = (icon: any): boolean => {\n    // @ts-ignore\n    return  isVNode(icon) && icon.type?.name?.indexOf('Icon') > -1\n};\n\n\nexport function getActiveElement(): HTMLElement | null {\n    return document ? document.activeElement as HTMLElement : null;\n}\n\nexport function isNodeContainsFocus(node: HTMLElement) {\n    const activeElement = getActiveElement();\n    return activeElement === node || node.contains(activeElement);\n}\n\n\n\nexport function getFocusableElements(node: HTMLElement) {\n    if (!isHTMLElement(node)) {\n        return [];\n    }\n    const focusableSelectorsList = [\n        \"input:not([disabled]):not([tabindex='-1'])\",\n        \"textarea:not([disabled]):not([tabindex='-1'])\",\n        \"button:not([disabled]):not([tabindex='-1'])\",\n        \"a[href]:not([tabindex='-1'])\",\n        \"select:not([disabled]):not([tabindex='-1'])\",\n        \"area[href]:not([tabindex='-1'])\",\n        \"iframe:not([tabindex='-1'])\",\n        \"object:not([tabindex='-1'])\",\n        \"*[tabindex]:not([tabindex='-1'])\",\n        \"*[contenteditable]:not([tabindex='-1'])\",\n    ];\n    const focusableSelectorsStr = focusableSelectorsList.join(',');\n    // we are not filtered elements which are invisible\n    const focusableElements = Array.from(node.querySelectorAll<HTMLElement>(focusableSelectorsStr));\n    return focusableElements;\n}\n\n\nexport async function runAfterTicks(func: (...args: any) => any, numberOfTicks: number) {\n    if (numberOfTicks===0) {\n        await func();\n        return;\n    } else {\n        await new Promise<void>(resolve=>{\n            setTimeout(async ()=>{\n                await runAfterTicks(func, numberOfTicks-1);\n                resolve();\n            }, 0);\n        });\n        return;\n    }\n}\n\n\n\n\nexport function getFragmentChildren(slots: SetupContext['slots']):VNode[] | undefined {\n    const children = slots.default?.()\n    return getChildren(children)\n}\n\nexport function getChildren(children: VNode[]):VNode[] | undefined {\n    if (children && Array.isArray(children) && children.length){\n        const newChildren = []\n        children.forEach(child=>{\n            if(child.type?.toString() === 'Symbol(v-fgt)' && Array.isArray(child.children)){\n                child.children.forEach(item=>{\n                    newChildren.push(item)\n                })\n            }else if(Array.isArray(child)){\n                child.map(item=>{\n                    newChildren.push(item)\n                })\n            }else{\n                newChildren.push(child)\n            }\n        })\n        return newChildren\n    }else{\n        return children\n    }\n}\n\n\n\n\n\n\nfunction getLeg(arr:VNode[], ) {\n    let nodes: VNode[] = []\n    arr.forEach(item=>{\n        if (typeof item.type === 'symbol'){\n        (Array.isArray(item.children) && item.children.length > 0) && (nodes = [...nodes, ...getLeg(item.children as VNode[])])\n        }else{\n            nodes.push(item)\n        }\n    })\n    return nodes\n}\n/**\n * 当使用vue的v-for时的特殊处理\n */\nexport function getVNodeChildren(arr:VNode[]){\n    return getLeg(arr)\n}\n\n\nexport function getScrollbarWidth() {\n    if (globalThis && Object.prototype.toString.call(globalThis) === '[object Window]') {\n        return window.innerWidth - document.documentElement.clientWidth;\n    }\n    return 0;\n}\n\n\nexport function styleNum(v: string | number) {\n    if (isNaN(+v)) {\n        return v\n    } else {\n        return v + 'px'\n    }\n}\n\n\n\nexport function isVNodeTypeNotSymbol(children:VNode) {\n    if(['Symbol(v-fgt)', 'Symbol(v-cmt)', 'Symbol(v-txt)'].indexOf(children.type.toString()) > -1){\n        return false\n    }\n    return true\n}\n\nexport function getMultinodeToFragment(slots: SetupContext['slots']):VNode {\n    let children = slots.default ? slots.default() : null;\n\n    if (Array.isArray(children) && children.length === 1) {\n        return children[0]\n    }\n    if (Array.isArray(children) && children.length > 1) {\n        return <>{children}</>\n    }\n}\n"],"names":["stopPropagation","e","noImmediate","stopImmediatePropagation","cloneDeep","value","customizer","cloneDeepWith","v","isVNode","Object","prototype","toString","call","Array","isArray","length","keys","newArray","forEach","key","set","warning","get","process","getHighLightTextHTML","sourceString","searchWords","option","autoEscape","caseSensitive","chunks","findAll","markEle","highlightTag","highlightClassName","highlightStyle","map","chunk","end","start","highlight","text","substr","h","style","className","registerMediaQuery","media","match","unmatch","callInInit","window","handlerMediaChange","matches","mediaQueryList","matchMedia","addEventListener","removeEventListener","isSemiIcon","icon","type","name","indexOf","getActiveElement","document","activeElement","isNodeContainsFocus","node","contains","getFocusableElements","isHTMLElement","focusableSelectorsStr","join","from","querySelectorAll","runAfterTicks","func","numberOfTicks","Promise","resolve","setTimeout","getFragmentChildren","slots","children","default","getChildren","newChildren","child","item","push","getLeg","arr","nodes","getVNodeChildren","getScrollbarWidth","globalThis","innerWidth","documentElement","clientWidth","styleNum","isNaN","isVNodeTypeNotSymbol","getMultinodeToFragment","_createVNode","_Fragment"],"mappings":"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"}