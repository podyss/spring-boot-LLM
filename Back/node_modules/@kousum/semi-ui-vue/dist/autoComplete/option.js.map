{"version":3,"file":"option.js","sources":["../../src/components/autoComplete/option.tsx"],"sourcesContent":["import classNames from 'classnames';\nimport * as PropTypes from '../PropTypes';\nimport { isString } from 'lodash';\nimport { cssClasses } from '@douyinfe/semi-foundation/autoComplete/constants';\nimport { LocaleConsumerFunc } from '../locale/localeConsumer';\nimport { IconTick } from '@kousum/semi-icons-vue';\nimport { getFragmentChildren, getHighLightTextHTML } from '../_utils/index';\nimport { Locale } from '../locale/interface';\nimport { BasicOptionProps } from '@douyinfe/semi-foundation/autoComplete/optionFoundation';\nimport { CombineProps, type RemoveIndexSignature, VueJsxNode } from '../interface';\nimport { ComponentObjectPropsOptions, CSSProperties, defineComponent, h, PropType, useSlots, type VNode } from 'vue';\nimport { vuePropsMake } from '../PropTypes';\nimport { StateOptionItem } from '@douyinfe/semi-foundation/autoComplete/foundation';\n\nconst LocaleConsumer = LocaleConsumerFunc<Locale['Select']>();\n\nexport interface OptionProps extends RemoveIndexSignature<BasicOptionProps> {\n  value?: string | number;\n  label?: string | number | VueJsxNode;\n  children?: VueJsxNode;\n  disabled?: boolean;\n  showTick?: boolean;\n  className?: string;\n  style?: CSSProperties;\n  option?: StateOptionItem;\n\n  //官方暂时还没有的类型\n  selected?: boolean\n  empty?: boolean,\n  emptyContent?: string | number | VNode | VNode[] | (()=>VNode),\n  inputValue?: string\n  renderOptionItem?: (...args: any)=>VNode\n  onMouseEnter?:  (e: MouseEvent) => any,\n  focused?: boolean,\n  onSelect?:  (opts: OptionProps, e: MouseEvent) => any,\n  prefixCls?: string,\n}\ninterface renderOptionContentArgument {\n  config: {\n    searchWords: any;\n    sourceString: VueJsxNode;\n  };\n  children: VueJsxNode;\n  inputValue: string;\n  prefixCls: string;\n}\n\nconst propTypes: CombineProps<OptionProps> = {\n  children: PropTypes.node,\n  disabled: PropTypes.bool,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  selected: PropTypes.bool,\n  label: PropTypes.node,\n  empty: PropTypes.bool,\n  emptyContent: PropTypes.node,\n  onSelect: PropTypes.func as PropType<OptionProps['onSelect']>,\n  focused: PropTypes.bool,\n  showTick: PropTypes.bool,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  onMouseEnter: PropTypes.func as PropType<OptionProps['onMouseEnter']>,\n  prefixCls: PropTypes.string,\n  renderOptionItem: PropTypes.func as PropType<OptionProps['renderOptionItem']>,\n  inputValue: PropTypes.string,\n  option: PropTypes.object,\n};\n\nconst defaultProps = {\n  prefixCls: cssClasses.PREFIX_OPTION,\n};\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\nconst Option = defineComponent({\n  props: { ...vuePropsType } as CombineProps<OptionProps>,\n  name: 'Option',\n  setup(props, {}) {\n    const slots = useSlots();\n    function onClick({ value, label, children, ...rest }: Partial<OptionProps>, event: MouseEvent) {\n      const isDisabled = props.disabled;\n      if (!isDisabled) {\n        props.onSelect({ ...rest, value, label: label || children }, event);\n      }\n    }\n\n    function renderOptionContent({ config, children, inputValue, prefixCls }: renderOptionContentArgument) {\n      if (isString(children) && inputValue) {\n        return getHighLightTextHTML(config as any);\n      }\n      return children;\n    }\n\n    return () => {\n      const children = getFragmentChildren(slots);\n      const {\n        disabled,\n        value,\n        selected,\n        label,\n        empty,\n        emptyContent,\n        onSelect,\n        focused,\n        showTick,\n        className,\n        style,\n        onMouseEnter,\n        prefixCls,\n        renderOptionItem,\n        inputValue,\n        ...rest_\n      } = props;\n      const rest = {\n        ...rest_,\n        ...props.option,\n      };\n      const optionClassName = classNames(prefixCls, {\n        [`${prefixCls}-disabled`]: disabled,\n        [`${prefixCls}-selected`]: selected,\n        [`${prefixCls}-focused`]: focused,\n        [`${prefixCls}-empty`]: empty,\n        [className]: className,\n      });\n      const selectedIconClassName = classNames([`${prefixCls}-icon`]);\n\n      if (empty) {\n        if (emptyContent === null) {\n          return null;\n        }\n        return (\n          <LocaleConsumer componentName=\"Select\">\n            {(locale: Locale['Select']) => (\n              <div class={optionClassName} x-semi-prop=\"emptyContent\">\n                {emptyContent || locale.emptyText}\n              </div>\n            )}\n          </LocaleConsumer>\n        );\n      }\n\n      // Since there are empty, locale and other logic, the custom renderOptionItem is directly converged to the internal option instead of being placed in Select/index\n      if (typeof renderOptionItem === 'function') {\n        return renderOptionItem({\n          disabled,\n          focused,\n          selected,\n          style,\n          label,\n          value,\n          inputValue,\n          onMouseEnter: (e: MouseEvent) => onMouseEnter(e),\n          onClick: (e: MouseEvent) => onClick({ value, label, children, ...rest }, e),\n          ...rest,\n        });\n      }\n\n      const config = {\n        searchWords: inputValue,\n        sourceString: children,\n        option: {\n          highlightClassName: `${prefixCls}-keyword`,\n        },\n      };\n      return (\n        // eslint-disable-next-line jsx-a11y/interactive-supports-focus,jsx-a11y/click-events-have-key-events\n        <div\n          class={optionClassName}\n          onClick={(e) => {\n            onClick({ value, label, children, ...rest }, e);\n          }}\n          onMouseenter={(e) => onMouseEnter && onMouseEnter(e)}\n          role=\"option\"\n          aria-selected={selected ? 'true' : 'false'}\n          aria-disabled={disabled ? 'true' : 'false'}\n          style={style}\n        >\n          {showTick ? (\n            <div class={selectedIconClassName}>\n              <IconTick />\n            </div>\n          ) : null}\n          {isString(children) ? (\n            <div class={`${prefixCls}-text`}>{renderOptionContent({ children, config, inputValue, prefixCls })}</div>\n          ) : (\n            children\n          )}\n        </div>\n      );\n    };\n  },\n});\n\n// @ts-ignore\nOption.isSelectOption = true;\nexport default Option;\n"],"names":["LocaleConsumer","LocaleConsumerFunc","propTypes","children","PropTypes","node","disabled","bool","value","oneOfType","string","number","selected","label","empty","emptyContent","onSelect","func","focused","showTick","className","style","object","onMouseEnter","prefixCls","renderOptionItem","inputValue","option","defaultProps","cssClasses","PREFIX_OPTION","vuePropsType","vuePropsMake","Option","defineComponent","props","name","setup","slots","useSlots","onClick","rest","event","renderOptionContent","config","isString","getHighLightTextHTML","getFragmentChildren","rest_","optionClassName","classNames","selectedIconClassName","_createVNode","default","locale","emptyText","e","searchWords","sourceString","highlightClassName","IconTick","isSelectOption"],"mappings":"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"}