{"version":3,"file":"SideSheetContent.js","sources":["../../src/components/sideSheet/SideSheetContent.tsx"],"sourcesContent":["import * as PropTypes from '../PropTypes';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/sideSheet/constants';\nimport Button from '../iconButton';\nimport { noop } from 'lodash';\nimport { IconClose } from '@kousum/semi-icons-vue';\nimport {\n  ComponentObjectPropsOptions,\n  CSSProperties,\n  StyleValue,\n  defineComponent,\n  h,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  ref,\n  useSlots,\n} from 'vue';\nimport { vuePropsMake } from '../PropTypes';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { SideSheetProps } from '@douyinfe/semi-foundation/sideSheet/sideSheetFoundation';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\n\nlet uuid = 0;\nconst prefixCls = cssClasses.PREFIX;\n\nexport interface SideSheetContentProps {\n  onClose?: (e: MouseEvent) => void;\n  closeIcon?: VueJsxNode;\n  mask?: boolean;\n  maskStyle?: CSSProperties;\n  maskClosable?: boolean;\n  maskClassName?: string;\n  title?: VueJsxNode;\n  closable?: boolean;\n  headerStyle?: CSSProperties;\n  width: string | number;\n  height: string | number;\n  style: CSSProperties;\n  size: SideSheetProps['size'];\n  bodyStyle?: CSSProperties;\n  className: string;\n  dialogClassName?: string;\n  footer?: VueJsxNode;\n  'aria-label'?: string;\n  maskExtraProps?: { [key: string]: any };\n  wrapperExtraProps?: { [key: string]: any };\n\n  motion?: boolean;\n  visible?: boolean;\n}\n\nconst propTypes: CombineProps<SideSheetContentProps> = {\n  size: {\n    type: String as PropType<SideSheetContentProps['size']>,\n    required: true\n  },\n  onClose: PropTypes.func as PropType<SideSheetContentProps['onClose']>,\n  closeIcon: PropTypes.node,\n  mask: PropTypes.bool,\n  maskStyle: PropTypes.object as PropType<SideSheetContentProps['maskStyle']>,\n  maskClosable: PropTypes.bool,\n  maskClassName: PropTypes.string,\n  title: PropTypes.node,\n  closable: PropTypes.bool,\n  headerStyle: PropTypes.object as PropType<SideSheetContentProps['headerStyle']>,\n  width: {\n    type: [PropTypes.string, PropTypes.number] as PropType<SideSheetContentProps['width']>,\n    required: true\n  },\n  height: {\n    type: [PropTypes.string, PropTypes.number] as PropType<SideSheetContentProps['height']>,\n    required: true\n  },\n  style: {\n    type: PropTypes.object as PropType<SideSheetContentProps['style']>,\n    required: true\n  },\n  bodyStyle: PropTypes.object as PropType<SideSheetContentProps['bodyStyle']>,\n  className: {\n    type: PropTypes.string,\n    required: true\n  },\n  dialogClassName: PropTypes.string,\n  footer: PropTypes.node,\n  'aria-label': PropTypes.string,\n  maskExtraProps: PropTypes.object,\n  wrapperExtraProps: PropTypes.object,\n  // children: PropTypes.node as PropType<SideSheetContentProps['children']>,\n\n  motion: PropTypes.bool as PropType<SideSheetContentProps['motion']>,\n  visible: PropTypes.bool as PropType<SideSheetContentProps['visible']>,\n};\n\nconst defaultProps = {\n  onClose: noop,\n};\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\nconst SideSheetContent = defineComponent({\n  props: {...vuePropsType},\n  name: 'SideSheetContent',\n  setup(props, {}) {\n    const slots = useSlots();\n    let sideSheetId: string;\n    let timeoutId: number;\n    onMounted(() => {\n      sideSheetId = `sidesheet-${uuid++}`;\n    });\n    onBeforeUnmount(() => {\n      clearTimeout(timeoutId);\n    });\n\n    const onMaskClick = (e: MouseEvent) => {\n      if (e.target === e.currentTarget) {\n        close(e);\n      }\n    };\n\n    const close = (e: MouseEvent) => {\n      const { onClose } = props;\n      onClose && onClose(e);\n    };\n\n    function getMaskElement() {\n      const { mask, maskStyle, maskClosable } = props;\n      if (mask) {\n        return (\n          <div\n            aria-hidden={true}\n            key=\"mask\"\n            class={cls(`${prefixCls}-mask`, props.maskClassName ?? '')}\n            style={maskStyle}\n            onClick={maskClosable ? onMaskClick : null}\n            {...props.maskExtraProps}\n          />\n        );\n      }\n      return null;\n    }\n\n    function renderHeader() {\n      const { title, closable, headerStyle, closeIcon } = props;\n      let header, closer;\n      if (title) {\n        header = (\n          <div class={`${prefixCls}-title`} x-semi-prop=\"title\">\n            {props.title}\n          </div>\n        );\n      }\n      if (closable) {\n        const iconType = closeIcon || <IconClose />;\n        closer = (\n          <Button\n            className={`${prefixCls}-close`}\n            key=\"close-btn\"\n            onClick={close}\n            type=\"tertiary\"\n            icon={iconType}\n            theme=\"borderless\"\n            size=\"small\"\n          />\n        );\n      }\n      return (\n        <div class={`${prefixCls}-header`} role={'heading'} aria-level={1} style={{ ...headerStyle }}>\n          {header}\n          {closer}\n        </div>\n      );\n    }\n\n    function getDialogElement() {\n      const style: CSSProperties = {};\n      if (props.width) {\n        style.width = typeof props.width === 'string' ? props.width : props.width + 'px';\n        // When the mask is false, the width is set on the wrapper. At this time, sidesheet-inner does not need to set the width again, otherwise, the percentage will be accumulated repeatedly when the width is a percentage\n        if (!props.mask) {\n          style.width = '100%';\n        }\n      }\n      if (props.height) {\n        style.height = typeof props.height === 'string' ? props.height : props.height + 'px';\n      }\n      const header = renderHeader();\n      const dialogElement = (\n        <div\n          key=\"dialog-element\"\n          role=\"dialog\"\n          tabindex={-1}\n          class={cls(`${prefixCls}-inner`, `${prefixCls}-inner-wrap`, props.dialogClassName ?? '')}\n          // onMouseDown={this.onDialogMouseDown}\n          style={{ ...props.style, ...style }}\n          {...props.wrapperExtraProps}\n          // id={this.dialogId}\n        >\n          <div class={`${prefixCls}-content`}>\n            {header}\n            <div class={`${prefixCls}-body`} style={props.bodyStyle} x-semi-prop=\"children\">\n              {slots.default?.()}\n            </div>\n            {props.footer ? (\n              <div class={`${prefixCls}-footer`} x-semi-prop=\"footer\">\n                {props.footer}\n              </div>\n            ) : null}\n          </div>\n        </div>\n      );\n      return dialogElement;\n    }\n\n    return () => {\n      const {\n        mask,\n        className,\n        width,\n        onClose,\n        maskStyle,\n        maskClosable,\n        maskClassName,\n        title,\n        closable,\n        headerStyle,\n        height,\n        style,\n        size,\n        bodyStyle,\n        dialogClassName,\n        footer,\n        maskExtraProps,\n        wrapperExtraProps,\n        ...rest\n      } = props;\n      const wrapperCls = cls(className, {\n        [`${prefixCls}-fixed`]: !mask,\n      });\n      const wrapperStyle: CSSProperties = {};\n      if (!mask && width) {\n        wrapperStyle.width = typeof width === 'string' ? width : width + 'px';\n      }\n\n      const dataAttr = getDataAttr(rest);\n\n      return (\n        <div class={wrapperCls} style={wrapperStyle} {...dataAttr}>\n          {getMaskElement()}\n          {getDialogElement()}\n        </div>\n      );\n    };\n  },\n});\n\nexport default SideSheetContent;\n"],"names":["prefixCls","cssClasses","PREFIX","propTypes","size","type","String","required","onClose","PropTypes","func","closeIcon","node","mask","bool","maskStyle","object","maskClosable","maskClassName","string","title","closable","headerStyle","width","number","height","style","bodyStyle","className","dialogClassName","footer","maskExtraProps","wrapperExtraProps","motion","visible","defaultProps","noop","vuePropsType","vuePropsMake","SideSheetContent","defineComponent","props","name","setup","slots","useSlots","timeoutId","onMounted","onBeforeUnmount","clearTimeout","onMaskClick","e","target","currentTarget","close","getMaskElement","_createVNode","_mergeProps","cls","renderHeader","header","closer","iconType","IconClose","Button","getDialogElement","default","rest","wrapperCls","wrapperStyle","dataAttr","getDataAttr"],"mappings":";;;;;;;;;AAwBA,MAAMA,IAAYC,EAAWC,QA4BvBC,IAAiD;AAAA,EACrDC,MAAM;AAAA,IACJC,MAAMC;AAAAA,IACNC,UAAU;AAAA,EACX;AAAA,EACDC,SAASC,EAAUC;AAAAA,EACnBC,WAAWF,EAAUG;AAAAA,EACrBC,MAAMJ,EAAUK;AAAAA,EAChBC,WAAWN,EAAUO;AAAAA,EACrBC,cAAcR,EAAUK;AAAAA,EACxBI,eAAeT,EAAUU;AAAAA,EACzBC,OAAOX,EAAUG;AAAAA,EACjBS,UAAUZ,EAAUK;AAAAA,EACpBQ,aAAab,EAAUO;AAAAA,EACvBO,OAAO;AAAA,IACLlB,MAAM,CAACI,EAAUU,QAAQV,EAAUe,MAAM;AAAA,IACzCjB,UAAU;AAAA,EACX;AAAA,EACDkB,QAAQ;AAAA,IACNpB,MAAM,CAACI,EAAUU,QAAQV,EAAUe,MAAM;AAAA,IACzCjB,UAAU;AAAA,EACX;AAAA,EACDmB,OAAO;AAAA,IACLrB,MAAMI,EAAUO;AAAAA,IAChBT,UAAU;AAAA,EACX;AAAA,EACDoB,WAAWlB,EAAUO;AAAAA,EACrBY,WAAW;AAAA,IACTvB,MAAMI,EAAUU;AAAAA,IAChBZ,UAAU;AAAA,EACX;AAAA,EACDsB,iBAAiBpB,EAAUU;AAAAA,EAC3BW,QAAQrB,EAAUG;AAAAA,EAClB,cAAcH,EAAUU;AAAAA,EACxBY,gBAAgBtB,EAAUO;AAAAA,EAC1BgB,mBAAmBvB,EAAUO;AAAAA;AAAAA,EAG7BiB,QAAQxB,EAAUK;AAAAA,EAClBoB,SAASzB,EAAUK;AACrB,GAEMqB,IAAe;AAAA,EACnB3B,SAAS4B;AACX,GACaC,IAAeC,EAAanC,GAAWgC,CAAY,GAC1DI,KAAmBC,gBAAAA,EAAgB;AAAA,EACvCC,OAAO;AAAA,IAAC,GAAGJ;AAAAA,EAAa;AAAA,EACxBK,MAAM;AAAA,EACNC,MAAMF,GAAO,IAAI;AACf,UAAMG,IAAQC;AAEd,QAAIC;AACJC,IAAAA,EAAU,MAAM;AAAA,IAEhB,CAAC,GACDC,EAAgB,MAAM;AACpBC,mBAAaH,CAAS;AAAA,IACxB,CAAC;AAED,UAAMI,IAAeC,CAAAA,MAAkB;AACrC,MAAIA,EAAEC,WAAWD,EAAEE,iBACjBC,EAAMH,CAAC;AAAA,OAILG,IAASH,CAAAA,MAAkB;AAC/B,YAAM;AAAA,QAAE3C,SAAAA;AAAAA,MAAS,IAAGiC;AACpBjC,MAAAA,KAAWA,EAAQ2C,CAAC;AAAA;AAGtB,aAASI,IAAiB;AACxB,YAAM;AAAA,QAAE1C,MAAAA;AAAAA,QAAME,WAAAA;AAAAA,QAAWE,cAAAA;AAAAA,MAAc,IAAGwB;AAC1C,aAAI5B,IACF2C,SAAAC,EAAA;AAAA,QAAA,eAEiB;AAAA,QAAI,KAAA;AAAA,QAAA,OAEVC,EAAI,GAAG1D,CAAS,SAASyC,EAAMvB,iBAAiB,EAAE;AAAA,QAAC,OACnDH;AAAAA,QAAS,SACPE,IAAeiC,IAAc;AAAA,MAClCT,GAAAA,EAAMV,cAAc,GAAA,IAAA,IAIvB;AAAA,IACT;AAEA,aAAS4B,IAAe;AACtB,YAAM;AAAA,QAAEvC,OAAAA;AAAAA,QAAOC,UAAAA;AAAAA,QAAUC,aAAAA;AAAAA,QAAaX,WAAAA;AAAAA,MAAW,IAAG8B;AACpD,UAAImB,GAAQC;AAQZ,UAPIzC,MACFwC,IAAMJ,EAAA,OAAA;AAAA,QAAA,OACQ,GAAGxD,CAAS;AAAA,QAAQ,eAAA;AAAA,SAC7ByC,CAAAA,EAAMrB,KAAK,CAEf,IAECC,GAAU;AACZ,cAAMyC,IAAWnD,KAAS6C,EAAAO,GAAiB,MAAA,IAAA;AAC3CF,QAAAA,IAAML,EAAAQ,GAAA;AAAA,UAAA,WAES,GAAGhE,CAAS;AAAA,UAAQ,KAAA;AAAA,UAAA,SAEtBsD;AAAAA,UAAK,MAAA;AAAA,UAAA,MAERQ;AAAAA,UAAQ,OAAA;AAAA,UAAA,MAAA;AAAA,QAIjB,GAAA,IAAA;AAAA,MACH;AACA,aAAAN,EAAA,OAAA;AAAA,QAAA,OACc,GAAGxD,CAAS;AAAA,QAAS,MAAQ;AAAA,QAAS,cAAc;AAAA,QAAC,OAAS;AAAA,UAAE,GAAGsB;AAAAA,QAAY;AAAA,SACxFsC,CAAAA,GACAC,CAAM,CAAA;AAAA,IAGb;AAEA,aAASI,IAAmB;;AAC1B,YAAMvC,IAAuB,CAAA;AAC7B,MAAIe,EAAMlB,UACRG,EAAMH,QAAQ,OAAOkB,EAAMlB,SAAU,WAAWkB,EAAMlB,QAAQkB,EAAMlB,QAAQ,MAEvEkB,EAAM5B,SACTa,EAAMH,QAAQ,UAGdkB,EAAMhB,WACRC,EAAMD,SAAS,OAAOgB,EAAMhB,UAAW,WAAWgB,EAAMhB,SAASgB,EAAMhB,SAAS;AAElF,YAAMmC,IAASD;AAyBf,aAxBmBH,EAAA,OAAAC,EAAA;AAAA,QAAA,KAAA;AAAA,QAAA,MAAA;AAAA,QAAA,UAIL;AAAA,QAAE,OACLC,EAAI,GAAG1D,CAAS,UAAU,GAAGA,CAAS,eAAeyC,EAAMZ,mBAAmB,EAAE;AAAA,QAAC,OAEjF;AAAA,UAAE,GAAGY,EAAMf;AAAAA,UAAO,GAAGA;AAAAA,QAAM;AAAA,MAAC,GAC/Be,EAAMT,iBAAiB,GAAA,CAAAwB,EAAA,OAAA;AAAA,QAAA,OAGf,GAAGxD,CAAS;AAAA,SACrB4D,CAAAA,GAAMJ,EAAA,OAAA;AAAA,QAAA,OACK,GAAGxD,CAAS;AAAA,QAAO,OAASyC,EAAMd;AAAAA,QAAS,eAAA;AAAA,SACpDiB,EAAAA,IAAAA,EAAMsB,YAANtB,gBAAAA,EAAAA,KAAAA,EAAiB,IAEnBH,EAAMX,SAAM0B,EAAA,OAAA;AAAA,QAAA,OACC,GAAGxD,CAAS;AAAA,QAAS,eAAA;AAAA,MAAA,GAAA,CAC9ByC,EAAMX,MAAM,CAAA,IAEb,IAAI,CAGb,CAAA,CAAA;AAAA,IAEH;AAEA,WAAO,MAAM;AACX,YAAM;AAAA,QACJjB,MAAAA;AAAAA,QACAe,WAAAA;AAAAA,QACAL,OAAAA;AAAAA,QACAf,SAAAA;AAAAA,QACAO,WAAAA;AAAAA,QACAE,cAAAA;AAAAA,QACAC,eAAAA;AAAAA,QACAE,OAAAA;AAAAA,QACAC,UAAAA;AAAAA,QACAC,aAAAA;AAAAA,QACAG,QAAAA;AAAAA,QACAC,OAAAA;AAAAA,QACAtB,MAAAA;AAAAA,QACAuB,WAAAA;AAAAA,QACAE,iBAAAA;AAAAA,QACAC,QAAAA;AAAAA,QACAC,gBAAAA;AAAAA,QACAC,mBAAAA;AAAAA,QACA,GAAGmC;AAAAA,MACJ,IAAG1B,GACE2B,IAAaV,EAAI9B,GAAW;AAAA,QAChC,CAAC,GAAG5B,CAAS,QAAQ,GAAG,CAACa;AAAAA,MAC3B,CAAC,GACKwD,IAA8B,CAAA;AACpC,MAAI,CAACxD,KAAQU,MACX8C,EAAa9C,QAAQ,OAAOA,KAAU,WAAWA,IAAQA,IAAQ;AAGnE,YAAM+C,IAAWC,EAAYJ,CAAI;AAEjC,aAAAX,SAAAC,EAAA;AAAA,QAAA,OACcW;AAAAA,QAAU,OAASC;AAAAA,SAAkBC,CAAQ,IACtDf,EAAgB,GAChBU,EAAgB,CAAE,CAAA;AAAA;EAI3B;AACF,CAAC;"}