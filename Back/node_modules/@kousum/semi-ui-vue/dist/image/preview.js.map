{"version":3,"file":"preview.js","sources":["../../src/components/image/preview.tsx"],"sourcesContent":["import { PreviewContext } from './previewContext';\nimport * as PropTypes from '../PropTypes';\nimport { vuePropsMake } from '../PropTypes';\nimport { PreviewProps, PreviewState } from './interface';\nimport PreviewInner from './previewInner';\nimport PreviewFoundation from '@douyinfe/semi-foundation/image/previewFoundation';\nimport { getUuidShort } from '@douyinfe/semi-foundation/utils/uuid';\nimport { cssClasses } from '@douyinfe/semi-foundation/image/constants';\nimport { isEqual, isObject, omit } from 'lodash';\nimport '@douyinfe/semi-foundation/image/image.scss';\nimport {\n  cloneVNode,\n  defineComponent,\n  h,\n  isVNode,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  reactive,\n  ref,\n  shallowRef,\n  useSlots,\n  VNode,\n  watch,\n} from 'vue';\nimport { useBaseComponent, useHasInProps } from '../_base/baseComponent';\nimport { CombineProps, VueJsxNode } from '../interface';\nimport { getChildren, getFragmentChildren, getVNodeChildren } from '../_utils';\nimport cls from 'classnames';\n\nconst prefixCls = cssClasses.PREFIX;\n\nconst propTypes: CombineProps<PreviewProps> = {\n  style: PropTypes.object,\n  className: PropTypes.string,\n  visible: PropTypes.bool,\n  src: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  currentIndex: PropTypes.number,\n  defaultCurrentIndex: PropTypes.number,\n  defaultVisible: PropTypes.bool,\n  maskClosable: PropTypes.bool,\n  closable: PropTypes.bool,\n  zoomStep: PropTypes.number,\n  infinite: PropTypes.bool,\n  showTooltip: PropTypes.bool,\n  closeOnEsc: PropTypes.bool,\n  prevTip: PropTypes.string,\n  nextTip: PropTypes.string,\n  zoomInTip: PropTypes.string,\n  zoomOutTip: PropTypes.string,\n  downloadTip: PropTypes.string,\n  adaptiveTip: PropTypes.string,\n  originTip: PropTypes.string,\n  lazyLoad: PropTypes.bool,\n  lazyLoadMargin: PropTypes.string,\n  preLoad: PropTypes.bool,\n  preLoadGap: PropTypes.number,\n  previewCls: PropTypes.string,\n  previewStyle: PropTypes.object,\n  disableDownload: PropTypes.bool,\n  zIndex: PropTypes.number,\n  renderHeader: PropTypes.func as PropType<PreviewProps['renderHeader']>,\n  renderPreviewMenu: PropTypes.func as PropType<PreviewProps['renderPreviewMenu']>,\n  getPopupContainer: PropTypes.func as PropType<PreviewProps['getPopupContainer']>,\n  onVisibleChange: PropTypes.func as PropType<PreviewProps['onVisibleChange']>,\n  onChange: PropTypes.func as PropType<PreviewProps['onChange']>,\n  onClose: PropTypes.func as PropType<PreviewProps['onClose']>,\n  onZoomIn: PropTypes.func as PropType<PreviewProps['onZoomIn']>,\n  onZoomOut: PropTypes.func as PropType<PreviewProps['onZoomOut']>,\n  onPrev: PropTypes.func as PropType<PreviewProps['onPrev']>,\n  onNext: PropTypes.func as PropType<PreviewProps['onNext']>,\n  onDownload: PropTypes.func as PropType<PreviewProps['onDownload']>,\n  onRatioChange: PropTypes.func as PropType<PreviewProps['onRatioChange']>,\n  onRotateChange: PropTypes.func as PropType<PreviewProps['onRotateChange']>,\n  previewTitle: PropTypes.node as PropType<PreviewProps['previewTitle']>,\n  rotateTip: PropTypes.string,\n  viewerVisibleDelay: PropTypes.number,\n  crossOrigin: PropTypes.string as PropType<PreviewProps['crossOrigin']>,\n  maxZoom: PropTypes.number,\n  minZoom: PropTypes.number,\n  onRotateLeft: PropTypes.func as PropType<PreviewProps['onRotateLeft']>,\n  onDownloadError: PropTypes.func as PropType<PreviewProps['onDownloadError']>,\n  setDownloadName: PropTypes.func as PropType<PreviewProps['setDownloadName']>,\n  forwardRef: [Function, Object] as PropType<PreviewProps['forwardRef']>,\n};\n\nconst defaultProps = {\n  src: [],\n  lazyLoad: true,\n  lazyLoadMargin: '0px 100px 100px 0px',\n  closable: true,\n};\nexport const vuePropsType = vuePropsMake(propTypes, defaultProps);\nconst Preview = defineComponent({\n  props: { ...vuePropsType },\n  name: 'Preview',\n  setup(props, {}) {\n    const { getProps } = useHasInProps();\n    const slots = useSlots();\n    const state = reactive({\n      currentIndex: props.currentIndex || props.defaultCurrentIndex || 0,\n      visible: props.visible || props.defaultVisible || false,\n    });\n\n    const { adapter: adapterInject } = useBaseComponent<PreviewProps>(props, state);\n    function adapter_() {\n      return {\n        ...adapterInject(),\n      };\n    }\n    const adapter = adapter_();\n    const foundation = new PreviewFoundation(adapter);\n    const previewGroupId = getUuidShort({ prefix: 'semi-image-preview-group', length: 4 });\n    const previewRef = ref();\n    let previewObserver: IntersectionObserver;\n    // const previewObserver = new IntersectionObserver(entries => {\n    //       entries.forEach(item => {\n    //           const src = (item.target as any).dataset?.src;\n    //           if (item.isIntersecting && src) {\n    //               (item.target as any).src = src;\n    //               (item.target as any).removeAttribute(\"data-src\");\n    //               previewObserver.unobserve(item.target);\n    //           }\n    //       });\n    //   },\n    //   {\n    //       root: document.querySelector(`#${previewGroupId}`),\n    //       rootMargin: props.lazyLoadMargin,\n    //   }\n    // );\n\n    onMounted(() => {\n      props.lazyLoad && observerImages();\n    });\n\n    const children = shallowRef<VNode[]>([]);\n    // 监听子元素变化\n    watch([() => props.lazyLoad, children], ([a, newChildren], [_, prevPropsChildren], onCleanup) => {\n      if (props.lazyLoad) {\n        const prevChildrenKeys = prevPropsChildren?.map((child) => (isVNode(child) ? child.key : null));\n        const currChildrenKeys = newChildren?.map((child) => (isVNode(child) ? child.key : null));\n\n        if (!isEqual(prevChildrenKeys, currChildrenKeys)) {\n          nextTick(() => {\n            observerImages();\n          });\n        }\n      }\n    });\n\n    function observerImages() {\n      if (previewObserver) {\n        // cancel the observation of all elements of the previous observer\n        previewObserver.disconnect();\n      } else {\n        previewObserver = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((item) => {\n              const src = (item.target as any).dataset?.src;\n              if (item.isIntersecting && src) {\n                (item.target as any).src = src;\n                (item.target as any).removeAttribute('data-src');\n              }\n              previewObserver.unobserve(item.target);\n            });\n          },\n          {\n            root: document.querySelector(`#${previewGroupId}`),\n            rootMargin: props.lazyLoadMargin,\n          }\n        );\n      }\n      const allImgElement = document.querySelectorAll(`.${prefixCls}-img`);\n      allImgElement.forEach((item) => previewObserver.observe(item));\n    }\n\n    function getDerivedStateFromProps(props: PreviewProps, state: PreviewState) {\n      const willUpdateStates: Partial<PreviewState> = {};\n      if ('currentIndex' in getProps(props) && props.currentIndex !== state.currentIndex) {\n        willUpdateStates.currentIndex = props.currentIndex;\n      }\n      if ('visible' in getProps(props) && props.visible !== state.visible) {\n        willUpdateStates.visible = props.visible;\n      }\n      return willUpdateStates;\n    }\n\n    watch(\n      () => props,\n      (val) => {\n        const newState = getDerivedStateFromProps({ ...props }, { ...state });\n        newState &&\n          Object.keys(newState).forEach((key) => {\n            state[key] = newState[key];\n          });\n      },\n      { deep: true }\n    );\n\n    onBeforeUnmount(() => {\n      if (previewObserver) {\n        previewObserver.disconnect();\n        previewObserver = null;\n      }\n    });\n    const handleVisibleChange = (newVisible: boolean) => {\n      foundation.handleVisibleChange(newVisible);\n    };\n\n    const handleCurrentIndexChange = (index: number) => {\n      foundation.handleCurrentIndexChange(index);\n    };\n\n    const loopImageIndex = () => {\n      const children = getFragmentChildren(slots) || [];\n      let index = 0;\n      const srcListInChildren = [];\n      const titles: VueJsxNode = [];\n      const loop = (children_: VNode[]) => {\n        return children_.map((child) => {\n          if (child && child.type) {\n            // @ts-ignore\n            if (child.type.isSemiImage) {\n              const { src, preview, alt } = child.props;\n              if (preview || preview === undefined) {\n                const previewSrc = isObject(preview) ? (preview as any).src ?? src : src;\n                srcListInChildren.push(previewSrc);\n                titles.push(preview?.previewTitle);\n                return cloneVNode(child, { imageID: index++ });\n              }\n              return child;\n            }\n          }\n\n          if (child && child.children) {\n            child.children = loop(getChildren(child.children as VNode[]))\n            return cloneVNode(child, {}, )\n          }\n\n          return child;\n        });\n      };\n      return {\n        srcListInChildren,\n        newChildren: loop(getChildren(children)),\n        titles,\n      };\n    };\n\n    // TODO 关闭后再次打开图片不显示\n    return () => {\n      // @ts-ignore\n      children.value = slots.default?.()?.[0]?.children || [];\n      const { src, className, style, lazyLoad, setDownloadName, ...restProps } = getProps(props);\n      const previewInnerProps = {\n        ...omit(restProps, ['previewCls', 'previewStyle']),\n        className: restProps?.previewCls,\n        style: restProps?.previewStyle,\n      };\n      const { currentIndex, visible } = state;\n      const { srcListInChildren, newChildren, titles } = loopImageIndex();\n      const srcArr = Array.isArray(src) ? src : typeof src === 'string' ? [src] : [];\n      const finalSrcList = [...srcArr, ...srcListInChildren];\n      return (\n        <PreviewContext.Provider\n          value={{\n            isGroup: true,\n            previewSrc: finalSrcList,\n            titles: titles,\n            currentIndex,\n            visible,\n            lazyLoad,\n            previewObserver: previewObserver,\n            setCurrentIndex: handleCurrentIndexChange,\n            handleVisibleChange: handleVisibleChange,\n            setDownloadName: setDownloadName,\n          }}\n        >\n          <div id={previewGroupId} style={style} class={cls(`${prefixCls}-preview-group`, className)}>\n            {newChildren}\n          </div>\n          <PreviewInner\n            {...(handleVisibleChange?{\n              ...previewInnerProps,\n              onVisibleChange: handleVisibleChange\n            }:previewInnerProps)}\n            ref={previewRef}\n            src={finalSrcList}\n            currentIndex={currentIndex}\n            visible={visible}\n          />\n        </PreviewContext.Provider>\n      );\n    };\n  },\n});\n\nexport default Preview;\n"],"names":["prefixCls","cssClasses","PREFIX","propTypes","style","PropTypes","object","className","string","visible","bool","src","oneOfType","array","currentIndex","number","defaultCurrentIndex","defaultVisible","maskClosable","closable","zoomStep","infinite","showTooltip","closeOnEsc","prevTip","nextTip","zoomInTip","zoomOutTip","downloadTip","adaptiveTip","originTip","lazyLoad","lazyLoadMargin","preLoad","preLoadGap","previewCls","previewStyle","disableDownload","zIndex","renderHeader","func","renderPreviewMenu","getPopupContainer","onVisibleChange","onChange","onClose","onZoomIn","onZoomOut","onPrev","onNext","onDownload","onRatioChange","onRotateChange","previewTitle","node","rotateTip","viewerVisibleDelay","crossOrigin","maxZoom","minZoom","onRotateLeft","onDownloadError","setDownloadName","forwardRef","Function","Object","defaultProps","vuePropsType","vuePropsMake","Preview","defineComponent","props","name","setup","getProps","useHasInProps","slots","useSlots","state","reactive","adapter","adapterInject","useBaseComponent","adapter_","foundation","PreviewFoundation","previewGroupId","getUuidShort","prefix","length","previewRef","ref","previewObserver","onMounted","observerImages","children","shallowRef","watch","a","newChildren","_","prevPropsChildren","onCleanup","prevChildrenKeys","map","child","isVNode","key","currChildrenKeys","isEqual","nextTick","disconnect","IntersectionObserver","entries","forEach","item","target","dataset","isIntersecting","removeAttribute","unobserve","root","document","querySelector","rootMargin","querySelectorAll","observe","getDerivedStateFromProps","willUpdateStates","val","newState","keys","deep","onBeforeUnmount","handleVisibleChange","newVisible","handleCurrentIndexChange","index","loopImageIndex","getFragmentChildren","srcListInChildren","titles","loop","children_","type","isSemiImage","preview","alt","undefined","previewSrc","isObject","push","cloneVNode","imageID","getChildren","value","default","restProps","previewInnerProps","omit","finalSrcList","Array","isArray","_createVNode","PreviewContext","Provider","isGroup","setCurrentIndex","cls","PreviewInner","_mergeProps"],"mappings":"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"}