{"version":3,"file":"ModalContent.js","sources":["../../src/components/modal/ModalContent.tsx"],"sourcesContent":["/* eslint-disable eqeqeq */\nimport * as PropTypes from '../PropTypes';\nimport cls from 'classnames';\nimport { cssClasses } from '@douyinfe/semi-foundation/modal/constants';\nimport Button from '../iconButton';\nimport { Title as TypographyTitle } from '../typography';\nimport { useBaseComponent } from '../_base/baseComponent';\n// eslint-disable-next-line max-len\nimport ModalContentFoundation, {\n  ModalContentAdapter,\n  ModalContentProps,\n  ModalContentState,\n} from '@douyinfe/semi-foundation/modal/modalContentFoundation';\nimport { get, isFunction, isNumber, noop } from 'lodash';\nimport { IconClose } from '@kousum/semi-icons-vue';\nimport FocusTrapHandle from '@douyinfe/semi-foundation/utils/FocusHandle';\nimport {\n  ComponentObjectPropsOptions,\n  CSSProperties,\n  defineComponent,\n  h,\n  onBeforeUnmount,\n  onMounted,\n  onUnmounted,\n  PropType,\n  reactive,\n  ref,\n  useSlots,\n  VNode,\n  VNodeRef,\n} from 'vue';\nimport { vuePropsMake } from '../PropTypes';\nimport { useConfigContext } from '../configProvider/context/Consumer';\nimport getDataAttr from '@douyinfe/semi-foundation/utils/getDataAttr';\nimport { useAttrs } from 'vue';\nimport { CombineProps } from '../interface';\n\nlet uuid = 0;\n\nexport interface ModalContentReactProps extends ModalContentProps {}\n\nconst propTypes: CombineProps<ModalContentReactProps> = {\n  onClose: {\n    type: Function as PropType<ModalContentReactProps['onClose']>,\n    required: true\n  },\n  // close: PropTypes.func as PropType<ModalContentReactProps['close']>,\n  getContainerContext: {\n    type: PropTypes.func as PropType<ModalContentReactProps['getContainerContext']>,\n    required: true\n  },\n  contentClassName: PropTypes.string,\n  maskClassName: PropTypes.string,\n  onAnimationEnd: PropTypes.func as PropType<ModalContentReactProps['onAnimationEnd']>,\n  preventScroll: PropTypes.bool,\n  isFullScreen: PropTypes.bool,\n  maskExtraProps: Object,\n  contentExtraProps: Object,\n\n  title: PropTypes.any,\n  afterClose: Function as PropType<ModalContentReactProps['afterClose']>,\n  bodyStyle: Object,\n  cancelButtonProps: PropTypes.any,\n  cancelText: PropTypes.string,\n  centered: PropTypes.bool,\n  className: PropTypes.string,\n  closable: PropTypes.bool,\n  confirmLoading: PropTypes.bool,\n  cancelLoading: PropTypes.bool,\n  content: {\n    type: PropTypes.any,\n    default: undefined,\n  },\n  footer: {\n    type: PropTypes.any,\n    default: undefined,\n  },\n  hasCancel: PropTypes.bool,\n  header: {\n    type: PropTypes.any,\n    default: undefined,\n  },\n  height: [PropTypes.bool, PropTypes.string] as PropType<ModalContentReactProps['height']>,\n  mask: PropTypes.bool,\n  maskClosable: PropTypes.bool,\n  maskStyle: Object,\n  maskFixed: PropTypes.bool,\n  motion: PropTypes.any as PropType<ModalContentReactProps['motion']>,\n  okButtonProps: PropTypes.any,\n  okText: String,\n  okType: String as PropType<ModalContentReactProps['okType']>,\n  onCancel: Function as PropType<ModalContentReactProps['onCancel']>,\n  onOk: Function as PropType<ModalContentReactProps['onOk']>,\n  style: Object,\n  visible: PropTypes.bool,\n  width: [String, Number],\n  zIndex: Number,\n  icon: PropTypes.any,\n  getPopupContainer: Function as PropType<ModalContentReactProps['getPopupContainer']>,\n  closeIcon: PropTypes.any,\n  closeOnEsc: PropTypes.bool,\n  size: String as PropType<ModalContentReactProps['size']>,\n  lazyRender: PropTypes.bool,\n  keepDOM: PropTypes.bool,\n  direction: PropTypes.any,\n  fullScreen: PropTypes.bool,\n  modalContentClass: String,\n  footerFill: Boolean,\n};\nconst defaultProps = {\n  close: noop,\n  onClose: noop,\n  getContainerContext: noop,\n  contentClassName: '',\n  maskClassName: '',\n};\nexport const vuePropsType = vuePropsMake<ModalContentReactProps>(propTypes, defaultProps);\nconst ModalContent = defineComponent({\n  props: { ...vuePropsType },\n  name: 'ModalContent',\n  setup(props, {}) {\n    const slots = useSlots();\n    const attr = useAttrs();\n    let timeoutId: NodeJS.Timeout;\n\n    let { context } = useConfigContext();\n    let focusTrapHandle: FocusTrapHandle;\n\n    const state = reactive<ModalContentState>({\n      dialogMouseDown: false,\n      prevFocusElement: FocusTrapHandle.getActiveElement(),\n    });\n    let dialogId: string = `dialog-${uuid++}`;\n    const modalDialogRef = ref();\n\n    const { adapter: adapterInject } = useBaseComponent<ModalContentReactProps>(props, state);\n    function adapter_(): ModalContentAdapter {\n      return {\n        ...adapterInject<ModalContentReactProps, ModalContentState>(),\n        notifyClose: (e: MouseEvent) => {\n          props.onClose(e);\n        },\n        notifyDialogMouseDown: () => {\n          state.dialogMouseDown = true;\n        },\n        notifyDialogMouseUp: () => {\n          if (state.dialogMouseDown) {\n            // Not setting setTimeout triggers close when modal external mouseUp\n            timeoutId = setTimeout(() => {\n              state.dialogMouseDown = false;\n            }, 0);\n          }\n        },\n        addKeyDownEventListener: () => {\n          if (props.closeOnEsc) {\n            document.addEventListener('keydown', foundation.handleKeyDown.bind(foundation));\n          }\n        },\n        removeKeyDownEventListener: () => {\n          if (props.closeOnEsc) {\n            document.removeEventListener('keydown', foundation.handleKeyDown.bind(foundation));\n          }\n        },\n        getMouseState: () => state.dialogMouseDown,\n        modalDialogFocus: () => {\n          const { preventScroll } = props;\n          let activeElementInDialog;\n          if (modalDialogRef.value) {\n            const activeElement = FocusTrapHandle.getActiveElement();\n            activeElementInDialog = modalDialogRef.value.contains(activeElement);\n            focusTrapHandle?.destroy();\n            focusTrapHandle = new FocusTrapHandle(modalDialogRef.value, { preventScroll });\n          }\n          if (!activeElementInDialog) {\n            modalDialogRef?.value.focus({ preventScroll });\n          }\n        },\n        modalDialogBlur: () => {\n          modalDialogRef.value.blur();\n          focusTrapHandle?.destroy();\n        },\n        prevFocusElementReFocus: () => {\n          const { prevFocusElement } = state;\n          const { preventScroll } = props;\n          const focus = get(prevFocusElement, 'focus');\n          isFunction(focus) && prevFocusElement.focus({ preventScroll });\n        },\n      };\n    }\n    const adapter = adapter_();\n    const foundation = new ModalContentFoundation(adapter);\n\n    onMounted(() => {\n      foundation.handleKeyDownEventListenerMount();\n      foundation.modalDialogFocus();\n      const nodes = FocusTrapHandle.getFocusableElements(modalDialogRef.value);\n      if (!modalDialogRef.value.contains(document.activeElement)) {\n        // focus on first focusable element\n        nodes[0]?.focus();\n      }\n    });\n\n    onBeforeUnmount(() => {\n      clearTimeout(timeoutId);\n      foundation.destroy();\n    });\n\n    const onKeyDown = (e: MouseEvent) => {\n      foundation.handleKeyDown(e);\n    };\n\n    // Record when clicking the modal box\n    const onDialogMouseDown = () => {\n      foundation.handleDialogMouseDown();\n    };\n\n    // Cancel recording when clicking the modal box at the end\n    const onMaskMouseUp = () => {\n      foundation.handleMaskMouseUp();\n    };\n\n    // onMaskClick will judge dialogMouseDown before onMaskMouseUp updates dialogMouseDown\n    const onMaskClick = (e: MouseEvent) => {\n      foundation.handleMaskClick(e);\n    };\n\n    const close = (e: MouseEvent) => {\n      foundation.close(e);\n    };\n\n    const getMaskElement = () => {\n      const { mask, maskClassName } = props;\n      if (mask) {\n        const className = cls(`${cssClasses.DIALOG}-mask`, {\n          // [`${cssClasses.DIALOG}-mask-hidden`]: !props.visible,\n        });\n        return <div key=\"mask\" class={cls(className, maskClassName)} style={props.maskStyle} />;\n      }\n      return null;\n    };\n\n    const renderCloseBtn = () => {\n      const { closable, closeIcon } = props;\n      let closer;\n      if (closable) {\n        const iconType = (typeof closeIcon === 'function' ? closeIcon() : closeIcon) || (\n          <IconClose x-semi-prop=\"closeIcon\" />\n        );\n        closer = (\n          <Button\n            aria-label=\"close\"\n            class={`${cssClasses.DIALOG}-close`}\n            key=\"close-btn\"\n            onClick={close}\n            type=\"tertiary\"\n            icon={iconType}\n            theme=\"borderless\"\n            size=\"small\"\n          />\n        );\n      }\n      return closer;\n    };\n\n    const renderIcon = () => {\n      const { icon } = props;\n      return icon ? (\n        <span class={`${cssClasses.DIALOG}-icon-wrapper`} x-semi-prop=\"icon\">\n          {typeof icon === 'function' ? icon() : icon}\n        </span>\n      ) : null;\n    };\n\n    const renderHeader = () => {\n      if ('header' in adapter.getProps()) {\n        return typeof props.header === 'function' ? props.header() : props.header;\n      }\n      const { title } = props;\n      const closer = renderCloseBtn();\n      const icon = renderIcon();\n      return title === null || title === undefined ? null : (\n        <div class={`${cssClasses.DIALOG}-header`}>\n          {icon}\n          <TypographyTitle\n            heading={5}\n            class={`${cssClasses.DIALOG}-title`}\n            id={`${cssClasses.DIALOG}-title`}\n            x-semi-prop=\"title\"\n          >\n            {title}\n          </TypographyTitle>\n          {closer}\n        </div>\n      );\n    };\n\n    const renderBody = () => {\n      const { bodyStyle, title } = props;\n      const bodyCls = cls(`${cssClasses.DIALOG}-body`, {\n        [`${cssClasses.DIALOG}-withIcon`]: props.icon,\n      });\n      const closer = renderCloseBtn();\n      const icon = renderIcon();\n      const hasHeader = (title !== null && title !== undefined) || 'header' in adapter.getProps();\n      return hasHeader ? (\n        <div class={bodyCls} id={`${cssClasses.DIALOG}-body`} style={bodyStyle} x-semi-prop=\"children\">\n          {{\n            default: slots.default,\n          }}\n        </div>\n      ) : (\n        <div class={`${cssClasses.DIALOG}-body-wrapper`}>\n          {icon}\n          <div class={bodyCls} style={bodyStyle} x-semi-prop=\"children\">\n            {{\n              default: slots.default,\n            }}\n          </div>\n          {closer}\n        </div>\n      );\n    };\n\n    const getDialogElement = () => {\n      const style: CSSProperties = {};\n      const digCls = cls(`${cssClasses.DIALOG}`, {\n        [`${cssClasses.DIALOG}-centered`]: props.centered,\n        [`${cssClasses.DIALOG}-${props.size}`]: props.size,\n      });\n      if (props.width) {\n        style.width = isNumber(props.width) ? props.width + 'px' : props.width;\n      }\n      if (props.height) {\n        style.height = isNumber(props.height) ? props.height + 'px' : props.height;\n      }\n      if (props.isFullScreen) {\n        style.width = '100%';\n        style.height = '100%';\n        style.margin = 'unset';\n      }\n      const body = renderBody();\n      const header = renderHeader();\n      const footer = props.footer ? (\n        <div class={`${cssClasses.DIALOG}-footer`} x-semi-prop=\"footer\">\n          {props.footer}\n        </div>\n      ) : null;\n      const dialogElement = (\n        // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n        <div\n          key=\"dialog-element\"\n          class={digCls}\n          onMousedown={onDialogMouseDown}\n          style={{ ...props.style, ...style }}\n          id={dialogId}\n        >\n          <div\n            role=\"dialog\"\n            ref={modalDialogRef}\n            aria-modal=\"true\"\n            aria-labelledby={`${cssClasses.DIALOG}-title`}\n            aria-describedby={`${cssClasses.DIALOG}-body`}\n            onAnimationend={props.onAnimationEnd}\n            class={cls([\n              `${cssClasses.DIALOG}-content`,\n              props.contentClassName,\n              { [`${cssClasses.DIALOG}-content-fullScreen`]: props.isFullScreen },\n            ])}\n          >\n            {header}\n            {body}\n            {footer}\n          </div>\n        </div>\n      );\n      // return props.visible ? dialogElement : null;\n      return dialogElement;\n    };\n\n    return () => {\n      const { maskClosable, className, getPopupContainer, maskFixed, getContainerContext, ...rest } = props;\n      const { direction } = context.value;\n      const classList = cls(className, {\n        [`${cssClasses.DIALOG}-popup`]: getPopupContainer && getPopupContainer() !== globalThis?.document?.body && !maskFixed,\n        [`${cssClasses.DIALOG}-fixed`]: maskFixed,\n        [`${cssClasses.DIALOG}-rtl`]: direction === 'rtl',\n      });\n\n      const containerContext = getContainerContext();\n      const dataAttr = getDataAttr({ ...rest, ...attr });\n\n      const elem = (\n        <div class={classList} {...dataAttr}>\n          {getMaskElement()}\n          <div\n            role=\"none\"\n            class={cls({\n              [`${cssClasses.DIALOG}-wrap`]: true,\n              [`${cssClasses.DIALOG}-wrap-center`]: props.centered,\n            })}\n            onClick={maskClosable ? onMaskClick : null}\n            onMouseup={maskClosable ? onMaskMouseUp : null}\n            {...props.contentExtraProps}\n          >\n            {getDialogElement()}\n          </div>\n        </div>\n      );\n\n      // eslint-disable-next-line max-len\n      return containerContext && containerContext.Provider ? (\n        <containerContext.Provider value={containerContext.value}>{elem}</containerContext.Provider>\n      ) : (\n        elem\n      );\n    };\n  },\n});\n\nexport default ModalContent;\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","uuid","propTypes","onClose","type","Function","required","getContainerContext","PropTypes","func","contentClassName","string","maskClassName","onAnimationEnd","preventScroll","bool","isFullScreen","maskExtraProps","contentExtraProps","title","any","afterClose","bodyStyle","cancelButtonProps","cancelText","centered","className","closable","confirmLoading","cancelLoading","content","default","undefined","footer","hasCancel","header","height","mask","maskClosable","maskStyle","maskFixed","motion","okButtonProps","okText","String","okType","onCancel","onOk","style","visible","width","Number","zIndex","icon","getPopupContainer","closeIcon","closeOnEsc","size","lazyRender","keepDOM","direction","fullScreen","modalContentClass","footerFill","Boolean","defaultProps","close","noop","vuePropsType","vuePropsMake","ModalContent","defineComponent","props","name","setup","slots","useSlots","attr","useAttrs","timeoutId","context","useConfigContext","focusTrapHandle","state","reactive","dialogMouseDown","prevFocusElement","FocusTrapHandle","getActiveElement","dialogId","modalDialogRef","ref","adapter","adapterInject","useBaseComponent","adapter_","notifyClose","e","notifyDialogMouseDown","notifyDialogMouseUp","setTimeout","addKeyDownEventListener","document","addEventListener","foundation","handleKeyDown","bind","removeKeyDownEventListener","removeEventListener","getMouseState","modalDialogFocus","activeElementInDialog","value","activeElement","contains","destroy","focus","modalDialogBlur","blur","prevFocusElementReFocus","get","isFunction","ModalContentFoundation","onMounted","handleKeyDownEventListenerMount","nodes","getFocusableElements","onBeforeUnmount","clearTimeout","onDialogMouseDown","handleDialogMouseDown","onMaskMouseUp","handleMaskMouseUp","onMaskClick","handleMaskClick","getMaskElement","cls","cssClasses","DIALOG","_createVNode","renderCloseBtn","closer","iconType","IconClose","Button","renderIcon","renderHeader","getProps","TypographyTitle","renderBody","bodyCls","getDialogElement","digCls","isNumber","margin","body","rest","classList","globalThis","containerContext","dataAttr","getDataAttr","elem","_mergeProps","Provider"],"mappings":"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"}