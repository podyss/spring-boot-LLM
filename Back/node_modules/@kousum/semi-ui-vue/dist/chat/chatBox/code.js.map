{"version":3,"file":"code.js","sources":["../../../src/components/chat/chatBox/code.tsx"],"sourcesContent":["import { defineComponent, ref, h, Fragment, useSlots, VNode, PropType } from 'vue';\nimport { CombineProps } from '../../interface';\n\nimport { cssClasses } from '@douyinfe/semi-foundation/chat/constants';\nimport copy from 'copy-text-to-clipboard';\nimport { IconCopyStroked, IconTick } from '@kousum/semi-icons-vue';\nimport { nth } from 'lodash';\nimport { code } from '../../markdownRender/components';\n// code's default height type is html/js/css, add jsx & tsx;\n// import 'prismjs/components/prism-jsx.js';\n// import 'prismjs/components/prism-tsx.js';\nimport { LocaleConsumerFunc } from '../../locale/localeConsumer';\nimport { Locale } from '../../locale/interface';\nimport { useMemo } from '../../_utils/useMemo';\nconst { PREFIX_CHAT_BOX } = cssClasses;\nconst LocaleConsumer = LocaleConsumerFunc<Locale['Chat']>();\n\ninterface codeProps {\n  className?: string;\n  children?: string;\n}\n\nexport const vuePropsType: CombineProps<codeProps> = {\n  className: String,\n  children: String,\n};\nconst Code = defineComponent({\n  props: { ...vuePropsType },\n  name: 'chatCode',\n  setup(props, { attrs }) {\n    const slots = useSlots();\n    const copied = ref(false);\n    const language = useMemo(() => {\n      return nth(props.className?.split('-'), -1);\n    }, [()=>props.className]);\n\n    const onCopyButtonClick = () => {\n      copy(props.children as string);\n      copied.value = true;\n      setTimeout(() => {\n        copied.value = false;\n      }, 2000);\n    };\n    return () => {\n      return language.value ? (\n        <div class={`${PREFIX_CHAT_BOX}-content-code semi-always-dark`}>\n          <div class={`${PREFIX_CHAT_BOX}-content-code-topSlot`}>\n            <span class={`${PREFIX_CHAT_BOX}-content-code-topSlot-type`}>{language.value}</span>\n            <span class={`${PREFIX_CHAT_BOX}-content-code-topSlot-copy`}>\n              {copied.value ? (\n                <span class={`${PREFIX_CHAT_BOX}-content-code-topSlot-copy-wrapper`}>\n                  <IconTick />\n                  <LocaleConsumer componentName=\"Chat\">{(locale: Locale['Chat']) => locale['copied']}</LocaleConsumer>\n                </span>\n              ) : (\n                <button\n                  class={`${PREFIX_CHAT_BOX}-content-code-topSlot-copy-wrapper ${PREFIX_CHAT_BOX}-content-code-topSlot-toCopy`}\n                  onClick={onCopyButtonClick}\n                >\n                  <IconCopyStroked />\n                  <LocaleConsumer componentName=\"Chat\">{(locale: Locale['Chat']) => locale['copy']}</LocaleConsumer>\n                </button>\n              )}\n            </span>\n          </div>\n          {code({ ...props })}\n        </div>\n      ) : (\n        code({ ...props })\n      );\n    };\n  },\n});\n\nexport default Code;\n"],"names":["PREFIX_CHAT_BOX","cssClasses","LocaleConsumer","LocaleConsumerFunc","vuePropsType","className","String","children","Code","defineComponent","props","name","setup","attrs","useSlots","copied","ref","language","useMemo","nth","split","onCopyButtonClick","copy","value","setTimeout","_createVNode","IconTick","default","locale","IconCopyStroked","code"],"mappings":";;;;;;;;AAcA,MAAM;AAAA,EAAEA,iBAAAA;AAAgB,IAAIC,GACtBC,IAAiBC,EAAkB,GAO5BC,IAAwC;AAAA,EACnDC,WAAWC;AAAAA,EACXC,UAAUD;AACZ,GACME,IAAOC,gBAAAA,EAAgB;AAAA,EAC3BC,OAAO;AAAA,IAAE,GAAGN;AAAAA,EAAc;AAAA,EAC1BO,MAAM;AAAA,EACNC,MAAMF,GAAO;AAAA,IAAEG,OAAAA;AAAAA,EAAM,GAAG;AACRC,IAAAA,EAAU;AACxB,UAAMC,IAASC,EAAI,EAAK,GAClBC,IAAWC,EAAQ,MAAM;;AAC7B,aAAOC,GAAIT,IAAAA,EAAML,cAANK,gBAAAA,EAAiBU,MAAM,MAAM,EAAE;AAAA,IAC3C,GAAE,CAAC,MAAIV,EAAML,SAAS,CAAC,GAElBgB,IAAoBA,MAAM;AAC9BC,MAAAA,EAAKZ,EAAMH,QAAkB,GAC7BQ,EAAOQ,QAAQ,IACfC,WAAW,MAAM;AACfT,QAAAA,EAAOQ,QAAQ;AAAA,MAChB,GAAE,GAAI;AAAA;AAET,WAAO,MACEN,EAASM,QAAKE,EAAA,OAAA;AAAA,MAAA,OACP,GAAGzB,CAAe;AAAA,IAAgC,GAAA,CAAAyB,EAAA,OAAA;AAAA,MAAA,OAChD,GAAGzB,CAAe;AAAA,IAAuB,GAAA,CAAAyB,EAAA,QAAA;AAAA,MAAA,OACtC,GAAGzB,CAAe;AAAA,IAA4B,GAAA,CAAGiB,EAASM,KAAK,CAAA,GAAAE,EAAA,QAAA;AAAA,MAAA,OAC/D,GAAGzB,CAAe;AAAA,IAA4B,GAAA,CACxDe,EAAOQ,QAAKE,EAAA,QAAA;AAAA,MAAA,OACE,GAAGzB,CAAe;AAAA,IAAoC,GAAA,CAAAyB,EAAAC,GAAAD,MAAAA,IAAAA,GAAAA,EAAAvB,GAAA;AAAA,MAAA,eAAA;AAAA,IAAA,GAAA;AAAA,MAAAyB,SAE1BC,CAAAA,MAA2BA,EAAO;AAAA,IAAS,CAAA,CAAA,CAAA,IAAAH,EAAA,UAAA;AAAA,MAAA,OAI3E,GAAGzB,CAAe,sCAAsCA,CAAe;AAAA,MAA8B,SACnGqB;AAAAA,IAAiB,GAAA,CAAAI,EAAAI,GAAAJ,MAAAA,IAAAA,GAAAA,EAAAvB,GAAA;AAAA,MAAA,eAAA;AAAA,IAAA,GAAA;AAAA,MAAAyB,SAGaC,CAAAA,MAA2BA,EAAO;AAAA,IAE5E,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAGJE,EAAK;AAAA,MAAE,GAAGpB;AAAAA,KAAO,CAAC,CAGrBoB,IAAAA,EAAK;AAAA,MAAE,GAAGpB;AAAAA,IAAM,CAAC;AAAA,EAGvB;AACF,CAAC;"}