{"version":3,"file":"NoticeTransition.js","sources":["../../src/components/notification/NoticeTransition.tsx"],"sourcesContent":["import { Transition } from '@kousum/semi-animation-vue';\nimport { NoticePosition } from '@douyinfe/semi-foundation/notification/notificationFoundation';\nimport { Motion } from '../_base/base';\nimport {\n  ComponentObjectPropsOptions,\n  CSSProperties,\n  defineComponent,\n  FunctionalComponent,\n  h,\n  PropType,\n  useSlots,\n  VNode,\n} from 'vue';\nimport { CombineProps } from '../interface';\n\nexport type ArgsType<T> = T extends (...args: infer A) => any ? A : never;\n\nexport interface NoticeTransitionProps {\n  position?: NoticePosition;\n  children?: VNode | ((TransitionProps: any) => any) | VNode[] | ((transitionStyle: any) => VNode);\n  motion?: Motion<NoticeTransitionProps>;\n}\n\ntype NoticeTransitionFormatFuncType = (styles: { translate: string; opacity: string | number }) => any;\n\nexport const vuePropsType: CombineProps<NoticeTransitionProps> = {\n  position: String as PropType<NoticeTransitionProps['position']>,\n  children: {\n    type: [Object, Function] as PropType<NoticeTransitionProps['children']>,\n    // required: true\n  },\n  motion: [Object, String, Boolean],\n};\nconst NoticeTransition = defineComponent({\n  props: { ...vuePropsType },\n  name: 'NoticeTransition',\n  setup(props, {}) {\n    const slots = useSlots();\n    let children;\n\n    return () => {\n      let { motion = {} } = props;\n      const { position = 'topRight' } = props;\n\n      const formatStyle = function formatStyle({ translate, opacity }: ArgsType<NoticeTransitionFormatFuncType>[0]) {\n        let transform = `translateX(${translate}%)`;\n\n        if (position && typeof position === 'string') {\n          if (/left/i.test(position)) {\n            transform = `translateX(${-translate}%)`;\n          } else if (/right/i.test(position)) {\n            transform = `translateX(${translate}%)`;\n          } else if (/top/i.test(position)) {\n            transform = `translateY(${-translate}%)`;\n          } else {\n            transform = `translateY(${translate}%)`;\n          }\n        }\n\n        return {\n          transform,\n          opacity,\n        };\n      };\n\n      if (typeof motion === 'function') {\n        motion = motion(props);\n      } else if (!motion || typeof motion !== 'object') {\n        motion = {};\n      }\n\n      // TODO 缓存 children函数 用于退出动画\n      if (!children) {\n        children = props.children;\n      }\n      return (\n        <Transition\n          // onFrame={style => console.log(formatStyle(style))}\n          from={{ translate: 100, opacity: 0 }}\n          enter={{ translate: { val: 0, tension: 560, friction: 32 }, opacity: { val: 1, duration: 200 } } as any}\n          leave={\n            {\n              translate: { val: 100, easing: 'easeOutCubic', duration: 300 },\n              opacity: { val: 0, duration: 200 },\n            } as any\n          }\n          children={\n            typeof props.children === 'function'\n              ? (transitionStyle: ArgsType<NoticeTransitionFormatFuncType>[0]) => {\n                  let children_;\n                  if (props.children === null) {\n                    children_ = children;\n                  } else {\n                    children_ = props.children;\n                  }\n                  return children_?.(formatStyle(transitionStyle));\n                }\n              : props.children\n          }\n          {...motion}\n        ></Transition>\n      );\n    };\n  },\n});\n\nexport default NoticeTransition;\n"],"names":["vuePropsType","position","String","children","type","Object","Function","motion","Boolean","NoticeTransition","defineComponent","props","name","setup","useSlots","formatStyle","translate","opacity","transform","test","_createVNode","Transition","_mergeProps","val","tension","friction","duration","easing","transitionStyle","children_"],"mappings":";;AAyBO,MAAMA,IAAoD;AAAA,EAC/DC,UAAUC;AAAAA,EACVC,UAAU;AAAA,IACRC,MAAM,CAACC,QAAQC,QAAQ;AAAA;AAAA,EAExB;AAAA,EACDC,QAAQ,CAACF,QAAQH,QAAQM,OAAO;AAClC,GACMC,IAAmBC,gBAAAA,EAAgB;AAAA,EACvCC,OAAO;AAAA,IAAE,GAAGX;AAAAA,EAAc;AAAA,EAC1BY,MAAM;AAAA,EACNC,MAAMF,GAAO,IAAI;AACDG,IAAAA,EAAU;AACxB,QAAIX;AAEJ,WAAO,MAAM;AACX,UAAI;AAAA,QAAEI,QAAAA,IAAS,CAAC;AAAA,MAAG,IAAGI;AACtB,YAAM;AAAA,QAAEV,UAAAA,IAAW;AAAA,MAAY,IAAGU,GAE5BI,IAAc,SAAqB;AAAA,QAAEC,WAAAA;AAAAA,QAAWC,SAAAA;AAAAA,MAAqD,GAAG;AAC5G,YAAIC,IAAY,cAAcF,CAAS;AAEvC,eAAIf,KAAY,OAAOA,KAAa,aAC9B,QAAQkB,KAAKlB,CAAQ,IACvBiB,IAAY,cAAc,CAACF,CAAS,OAC3B,SAASG,KAAKlB,CAAQ,IAC/BiB,IAAY,cAAcF,CAAS,OAC1B,OAAOG,KAAKlB,CAAQ,IAC7BiB,IAAY,cAAc,CAACF,CAAS,OAEpCE,IAAY,cAAcF,CAAS,OAIhC;AAAA,UACLE,WAAAA;AAAAA,UACAD,SAAAA;AAAAA;;AAIJ,aAAI,OAAOV,KAAW,aACpBA,IAASA,EAAOI,CAAK,KACZ,CAACJ,KAAU,OAAOA,KAAW,cACtCA,IAAS,CAAA,IAINJ,MACHA,IAAWQ,EAAMR,WAEnBiB,EAAAC,GAAAC,EAAA;AAAA,QAAA,MAGU;AAAA,UAAEN,WAAW;AAAA,UAAKC,SAAS;AAAA,QAAG;AAAA,QAAA,OAC7B;AAAA,UAAED,WAAW;AAAA,YAAEO,KAAK;AAAA,YAAGC,SAAS;AAAA,YAAKC,UAAU;AAAA,UAAI;AAAA,UAAER,SAAS;AAAA,YAAEM,KAAK;AAAA,YAAGG,UAAU;AAAA,UAAI;AAAA,QAAG;AAAA,QAAA,OAE9F;AAAA,UACEV,WAAW;AAAA,YAAEO,KAAK;AAAA,YAAKI,QAAQ;AAAA,YAAgBD,UAAU;AAAA,UAAK;AAAA,UAC9DT,SAAS;AAAA,YAAEM,KAAK;AAAA,YAAGG,UAAU;AAAA,UAAI;AAAA,QAClC;AAAA,QAAA,UAGD,OAAOf,EAAMR,YAAa,aACrByB,CAAAA,MAAiE;AAChE,cAAIC;AACJ,iBAAIlB,EAAMR,aAAa,OACrB0B,IAAY1B,IAEZ0B,IAAYlB,EAAMR,UAEb0B,KAAAA,gBAAAA,EAAYd,EAAYa,CAAe;AAAA,QAC/C,IACDjB,EAAMR;AAAAA,MAAQ,GAEhBI,CAAM,GAAA,IAAA;AAAA;EAIlB;AACF,CAAC;"}